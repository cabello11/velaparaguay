/*! For license information please see sdk.js.LICENSE.txt */
(()=>{"use strict";var e,t,n={850:(e,t,n)=>{var r;t.__esModule=!0,t.consentEnabled=t.localStorageConsent=t.cookieConsent=void 0;var i,o=n(619),u=n(400);t.consentEnabled=!!(null===(r=null===window||void 0===window?void 0:window.pdl)||void 0===r?void 0:r.requireConsent),t.consentEnabled&&(i=o.storage.cookie.getTopLevelDomain(),u.dataLayer.init(),window.pdl.consent_modifiers={ESP:{source:"opt-out",patches:[{action:"exclude",item:{key:"pnespsdk_ssn",type:"cookie"}},{action:"exclude",item:{key:"pnespsdk_visitor",type:"cookie"}},{action:"exclude",item:{key:"pnespsdk_push_subscription_added",type:"cookie"}},{action:"exclude",item:{key:"pnespsdk_pnespid",type:"cookie"}},{action:"exclude",item:{key:"pnespsdk_user_closed",type:"cookie"}},{action:"include",item:{key:"lucidsdkver",type:"localStorage"}}]}},window.pdl.getESPConsentMode=function(){var e,t;return null===(t=null===(e=u.dataLayer.utils.getConsent())||void 0===e?void 0:e.ESP)||void 0===t?void 0:t.mode},window.pdl.setESPConsentMode=function(e){var t=u.dataLayer.utils.setConsent("ESP",e);t&&console.error("setConsent error",t)},t.cookieConsent=o.consent.createCookie({dataLayer:u.dataLayer,productName:"ESP",items:{pnespsdk_ssn:"mandatory",pnespsdk_visitor:"mandatory",pnespsdk_push_subscription_added:"mandatory",pnespsdk_pnespid:"mandatory",pnespsdk_user_closed:"mandatory"},enableAutoRemove:{domain:i}}),t.localStorageConsent=o.consent.createLocalStorage({dataLayer:u.dataLayer,productName:"ESP",items:{lucidsdkver:"mandatory"},enableAutoRemove:!0}))},619:(e,t,n)=>{n.r(t),n.d(t,{consent:()=>l,storage:()=>r});var r=n(522),i=function(e){return function(){var t=e.dataLayer.get("consent");return t&&t[e.productName]||null}},o=function(e,t){var n=null,r=function(r){var i=(null==r?void 0:r[e.productName])||null;i!==n&&(n=i,t(i))};return e.dataLayer.addChangeListener("consent",r),function(){e.dataLayer.removeChangeListener(r)}},u=function(e,t){return e.utils.checkConsent.createCheckConsentWrapper(t)},a=function(e,t,n){var r=e.utils.checkConsent,i=r.itemsToMask(t),o=Object.keys(t).filter((function(e){return!r.isMask(e)}));return n().filter((function(e){return o.includes(e)||r.getByMask(e,i)}))},s=function(e,t,n){var r,s=i(n),c=u(n.dataLayer,{items:n.items,type:t,getConsent:s}),l=function(t){var r;null===(r=c(a(n.dataLayer,n.items,e.getNames),t))||void 0===r||r.forEach((function(t){t.allowed?t.data&&e.set(t.name,t.data):e.remove(t.name)}))};return r=void 0===n.checkConsentOnInit&&n.enableAutoRemove,n.enableAutoRemove&&o(n,l),r&&l(s()),Object.assign({},e,{set:function(t,n,r){var i,o=c(t);if(null==o?void 0:o.allowed){var u=null!==(i=o.data)&&void 0!==i?i:n,a=r?[t,u,r]:[t,u];e.set.apply(null,a)}},check:c})},c=function(e,t){return{check:u(t.dataLayer,{items:t.items,type:e,getConsent:i(t)})}},l={createLocalStorage:function(e){var t=function(e){var t,n,a=r.localStorage.__protected__.ttlName,s={dataLayer:e,productName:"DL"},c=(n=u(s.dataLayer,{items:(t={},t[a]="mandatory",t),type:"localStorage",getConsent:i(s)}),function(){var e=n(a);return e.allowed&&!e.data}),l=!0,d=function(){(l=c())||r.localStorage.remove(a)};return o(s,d),d(),function(){return l}}(e.dataLayer),n=s(r.localStorage,"localStorage",e);return Object.assign({},n,{set:function(e,r,i){var o=i;return(null==i?void 0:i.expires)&&!t()&&delete(o=Object.assign({},i)).expires,n.set(e,r,o)}})},createProperty:function(e){return c("property",e)},createCookie:function(e){var t=e.dataLayer.utils.checkConsent,n=i(e),s={},c=[],l={},d={};Object.keys(e.items).forEach((function(n){var r=e.items[n];if(r.type){var i=r,o=i.type,u=i.domain,a=i.path,d={};l[n]=o,u&&(d.domain=u),a&&(d.path=a),t.isMask(n)?c.push(t.createMask(n,d)):s[n]=d}else l[n]=r}));var f,p=u(e.dataLayer,{items:l,type:"cookie",getConsent:n}),v=function(n){var i;null===(i=p(a(e.dataLayer,l,r.cookie.getNames),n))||void 0===i||i.forEach((function(e){var n=function(){return s[e.name]||t.getByMask(e.name,c)||d};e.allowed?e.data&&r.cookie.set(e.name,e.data,n()):r.cookie.remove(e.name,n())}))};return f=!(void 0!==e.checkConsentOnInit||!e.enableAutoRemove),e.enableAutoRemove&&(d=e.enableAutoRemove,o(e,v)),f&&v(n()),Object.assign({},r.cookie,{check:p,set:function(e,t,n,i){var o,u=p(e);(null==u?void 0:u.allowed)&&r.cookie.set(e,null!==(o=u.data)&&void 0!==o?o:t,n,i)}})},createSessionStorage:function(e){return s(r.sessionStorage,"sessionStorage",e)},createEvent:function(e){return c("event",e)}}},400:(e,t,n)=>{n.r(t),n.d(t,{dataLayer:()=>Xt,default:()=>Xt});var r=n(522),i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)},o=function(e,t){return void 0===t&&(t="_pctx"),{cookieName:t,readonly:!1,init:function(t){var n;return null!==(n=null!=t?t:e)&&void 0!==n?n:null},refresh:function(e){return e},update:function(e){return e},set:function(e){return e},get:function(e){return e}}},u=function(e){return i(i({},o(e)),{cookieName:null})},a=o("anon"),s=function(e){return e?Object.keys(e):[]},c=function(e){return Array.isArray(e)},l=function(e){return null==e},d=function(e){return!l(e)},f=function(e){return"object"==typeof e},p=function(e){return"string"==typeof e},v=function(){for(var e=(new Date).getTime().toString(36);e.length<16;)e+=Math.round(2147483647*Math.random()).toString(36);return e.substr(0,16)},g=function(e,t){return e?s(e).filter((function(n){return t(e[n])})).reduce((function(t,n){var r;return i(i({},t),((r={})[n]=e[n],r))}),{}):e},m=function(){var e={};return{add:function(t){e[t]=!0},values:function(){return s(e)}}},h=function(e){return"true"===e||!0===e},w=function(e,t){var n,r=NaN,i=NaN;return function(o){var u=null==t?void 0:t();return o===i&&r===u||(r=u,i=o,n=e(o)),n}},y=function(e){var t;return function(n){var r=e();r!==t&&(t=r,n(r))}},b=function(e,t){try{return e()}catch(e){return t?b(t):null}},P=function(e,t){return void 0===t&&(t=!1),b((function(){return JSON.parse(e)}),(function(){return t?JSON.parse(window.atob(e)):null}))||null},S=function(e,t){if(e===t)return!0;if(!e||!t)return null;var n=s(e),r=s(t);return n.length===r.length&&!n.some((function(n){return e[n]!==t[n]}))},k=function(e){return g(e,(function(e){return"CX"!==(null==e?void 0:e.type)}))},_=i(i({},o(null)),{init:function(e){return k(e||null)},refresh:k,set:function(e,t){return null===e?null:g(i(i({},t),e),(function(e){return null!==e}))}}),E=function(){return window.pdl||{}},C=function(e,t){return t({protect:!0}),v()},A=i(i({},u()),{init:function(e,t){return t({protect:!0}),E().pageViewId||v()},refresh:C,update:C,set:function(e,t,n){return n({protect:!0}),e}}),I=i(i({},o(null,"_pcid")),{init:function(e,t){return t({protect:!0}),e||v()},update:function(e,t){return t({protect:!0}),v()},set:function(e,t,n){return n({protect:!0}),e}}),D="DL",N=["PA","DMP","COMPOSER","ID","VX","ESP","SOCIAL_FLOW",D].map((function(e,t){return{name:e,id:t}})),j=N.reduce((function(e,t,n){var r,o=t.name;return i(i({},e),((r={})[o]=n,r[o.toLowerCase()]=n,r))}),{});j["social flow"]=j.SOCIAL_FLOW,j["Social Flow"]=j.SOCIAL_FLOW;var O,x=y((function(){var e;return null===(e=we(E().consent))||void 0===e?void 0:e.products})),W=(O=N,function(){return x((function(e){O=e?N.filter((function(t){return e.includes(t.name)||t.name===D})):N})),O}),M=function(e,t,n){var r=W().reduce((function(r,i){var o=i.id;return r[o]=n(null==e?void 0:e[o],null==t?void 0:t[o],o),r}),{});return S(r,t)?t:r},T=function(e){var t=Number(e);if(Number.isNaN(t)){var n=j[e.toLowerCase()];return null!=n?n:null}return t<N.length?t:null},L=function(e,t){return s(e).reduce((function(n,r){var i=N[Number(r)].name,o=e[r];return n[i]=t?t(o,i):o,n}),{})},F="opt-in",U="essential",q="opt-out",R="custom",$=[F,U,q],B=$.concat(R),V=B.reduce((function(e,t,n){var r;return i(i({},e),((r={})[n]=t,r))}),{}),H=[F,R,U,q],Y=function(e){return B.includes(e)},Q={AD:["DMP","SOCIAL_FLOW"],CP:["COMPOSER"],AM:["PA"],PR:["ESP","VX","ID"],DL:["DL"]},z=s(Q).reduce((function(e,t){return Q[t].forEach((function(n){var r=j[n];e[r]=t})),e}),{}),J=y((function(){var e;return null===(e=we(E().consent))||void 0===e?void 0:e.defaultPurposes})),K=function(){var e=i({},z);return function(){return J((function(t){e=i({},z),t&&s(t).forEach((function(n){var r,i=j[n];e[i]=null===(r=t[n])||void 0===r?void 0:r.substring(0,32)}))})),e}}(),G=function(e,t){return M(e,t,(function(e,t,n){return e||t||K()[n]}))},X=i(i({},o(null,"_pprv")),{init:function(e){return te()?G(e||null,null):null},set:function(e,t){return te()?null==e?t:G(function(e){return s(e).reduce((function(t,n){var r=T(n),i=ue(e[n]);return null===r||i===re||r===j[D]||i&&(t[r]=i),t}),{})}(e),t):null}}),Z=function(){return E().consent_modifiers||null},ee=function(){return!!E().requireConsent},te=function(){return"v2"===E().requireConsent},ne=function(e,t){var n;return e===R&&!(null===(n=Z())||void 0===n?void 0:n[t])},re="DL",ie=["AD","AM","CP","PR",re].reduce((function(e,t){var n;return i(i({},e),((n={})[t]=t,n[t.toLowerCase()]=t,n))}),{}),oe=function(e){return ie[(null==e?void 0:e.toLowerCase())||""]||null},ue=function(e){return oe(e)||(null==e?void 0:e.substring(0,32))},ae=function(e,t,n){return"".concat(e.join(", ")," ").concat(e.length>1?n:t)},se=function(e){return'"'.concat(e,'" can not be applied for the dl product')};var ce=function(e,t){if(!e)return null;var n=L(t||z);return W().reduce((function(t,r){var i,o,u,a,s,c=r.name,l=n[c],d=(null===(i=e[c])||void 0===i?void 0:i.mode)||F;return t[l]?(t[l].mode=(o=t[l].mode,u=d,a=H.indexOf(o),s=H.indexOf(u),H[Math.max(a,s)]),t[l].products.push(c)):t[l]={mode:d,products:[c]},t}),{})},le=["include","exclude","obfuscate"],de=function(e,t){return'"'.concat(e,'" should be one of ').concat(t.join(", "))},fe=function(){},pe=function(e,t){return function(n){return t(e+n)}},ve=function(e,t){void 0===t&&(t=fe);var n=j[e.toLowerCase()];return void 0!==n?N[n].name:(t('"'.concat(e,'" is not found')),null)},ge=function(e){return function(e){return $.includes(e)}(e)?e:null},me=function(e,t){void 0===t&&(t=fe);var n=e.source,r=e.patches||[];return ge(n)||(t(de("source",$)),n=F),c(r)||(t('"patches" should be an array'),r=[]),{source:n,patches:r=r.reduce((function(e,n,r){if(!f(n)||c(n))return t("patch[".concat(r,"]: should be type of {action, item, with?}")),e;var i=n.action,o=n.item;return le.includes(i)?o&&f(o)&&o.key&&o.type?(e.push(n),e):(t("patch[".concat(r,']: "item" should be type of {key, type}')),e):(t("patch[".concat(r,"]: ")+de("action",le)),e)}),[])}},he=function(e,t){if(void 0===t&&(t=fe),!e)return null;var n={};e.products&&(c(e.products)?n.products=e.products.reduce((function(e,n){var r=ve(n,pe("consent.products: ",t));return r&&e.push(r),e}),[]):t("consent.products: should be an array")),e.defaultPreset&&(n.defaultPreset=s(e.defaultPreset).reduce((function(n,r){var i=ve(r,pe("consent.defaultPreset: ",t)),o=ge(e.defaultPreset[r]);return o||t("consent.defaultPreset: "+de(r,$)),i&&o&&(n[i]=o),n}),{}));var r=e.defaultPurposes;return r&&(n.defaultPurposes=s(r).reduce((function(e,n){var i=pe("consent.defaultPurposes: ",t),o=ve(n,i),u=r[n],a=ue(u);return a===re||o===D?i('"'.concat(n,": ").concat(u,'" - invalid config')):o&&a&&(e[o]=a),e}),{})),n},we=w(he),ye=[[0,0,0,0,0,0,0,0],[0,0,2,2,2,2,2,0],[1,2,2,2,2,2,2,1],[0,2,0,2,2,2,0,0],[1,2,2,2,2,2,1,1],[2,0,0,2,2,2,2,0],[2,0,2,2,2,2,2,0],[2,2,2,2,2,2,0,2],[2,2,0,0,0,0,2,0],[2,2,1,2,1,2,2,1],[2,2,1,1,2,2,2,1]],be=function(e){return e.reduce((function(e,t,n){var r;return i(i({},e),((r={})[n]={mode:V[t]},r))}),{})},Pe=ye.map((function(e,t){return{id:t,preset:be(e)}})),Se=y((function(){var e;return null===(e=we(E().consent))||void 0===e?void 0:e.defaultPreset})),ke=function(){var e=Pe;return function(){return Se((function(t){e=Pe.slice(),t&&(e[0]={id:0,preset:i({},e[0].preset)},s(t).forEach((function(n){var r=t[n],i=j[n];e[0].preset[i]={mode:r}})))})),e}}(),_e=function(e,t){return M(e,t,(function(e,t,n){var r=(null==e?void 0:e.mode)||(null==t?void 0:t.mode)||ke()[0].preset[n].mode;return r!==(null==t?void 0:t.mode)?{mode:r}:t}))},Ee=i(i({},o(null,"_pprv")),{init:function(e){return ee()&&e?_e(e,null):null},set:function(e,t){var n,r,i;return ee()?null==e?t:(function(e){return"number"==typeof e}(e)?r=(null===(n=ke()[e])||void 0===n?void 0:n.preset)||null:c(e)?(i=null,e.forEach((function(e){var t=ye[e];i||!t?i&&t&&(i=i.map((function(e,n){return Math.min(e,t[n])}))):i=t})),r=i&&be(i)):r=function(e){return s(e).reduce((function(t,n){var r=e[n],i=T(n);if(null===i)return t;var o=Y(r.mode)?r.mode:null;return o&&(t||(t={}),t[i]={mode:o}),t}),null)}(e),r?_e(r,t):t):null},get:w((function(e){return e&&L(e,(function(e,t){var n,r=i({},e);return r.mode===R&&(r.modifier=(null===(n=Z())||void 0===n?void 0:n[t])||null),r}))}),(function(){return Z()}))}),Ce=i(i({},u()),{init:ke,set:ke}),Ae=i(i({},u()),{init:W,set:W}),Ie=i(i({},u(null)),{readonly:!0,set:function(){return null},get:Z}),De=function(e){var t=Number(e);return Number.isNaN(t)?String(e):t},Ne=function(e){return c(e)?e:e.split(",").map((function(e){return e.trim().replace(/^['"](.+)['"]$/,"$1")}))},je=function(e){return e},Oe={id:je,type:je,zone:je,createdAt:De,modifiedAt:De,authors:Ne,section:je,tags:Ne,keywords:Ne,title:je,description:je,isNative:h},xe=function(e){return"last"===e};function We(e,t){if(void 0===e&&(e="meta"),function(e){return"first"===e}(t))return document.querySelector(e);var n=document.querySelectorAll(e);return xe(t)?n[n.length-1]:Array.from(n)}var Me,Te=(Me=null,{refresh:function(){(Me=We()||null)&&setTimeout((function(){Me=null}),0)},find:function(e,t){return void 0===t&&(t=!1),Me?Me.reduce((function(n,r){for(var i=0,o=e;i<o.length;i++){var u=o[i],a=(("name"===u?r.name:r.getAttribute(u))||"").trim().toLowerCase(),s=r.content;if(a&&(!t||s)){n[a]||(n[a]=[]),n[a].push(r);break}}return n}),{}):null}}),Le=function(e){var t,n=e.getContent||function(e){return e.content};return e.selector?(t=We(e.selector,e.take||"first"))&&n(t)||null:function(){var t=Te.find(e.attr||["name"],e.hasContent),r=e.names||[],i=!("all"===e.take),o=xe(e.take);if(!t)return null;for(var u=function(e){var r=[],u=t[e];if(u){if(i){var a=u[o?u.length-1:0];return{value:n(a)||""}}u.forEach((function(e){r=r.concat(n(e)||"")}))}if(r.length)return{value:r}},a=0,s=r;a<s.length;a++){var c=u(s[a]);if("object"==typeof c)return c.value}return null}()},Fe=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t],i=Le(r);if(i)return i}},Ue=function(e,t,n){var r=Oe[t];if(!Boolean(e[t])&&r){var i=("function"==typeof n?n:function(){return c(n)?Fe(n):Le(n)})(),o=i&&r(i);o&&(e[t]=o)}},qe=function(e){return{names:[e]}},Re={januar:"01",january:"01",jan:"01",februar:"02",february:"02",feb:"02",mars:"03",march:"03",mar:"03",april:"04",apr:"04",mai:"05",may:"05",juni:"06",june:"06",jun:"06",juli:"07",july:"07",jul:"07",august:"08",aug:"08",september:"09",sept:"09",sep:"09",oktober:"10",october:"10",okt:"10",oct:"10",november:"11",nov:"11",desember:"12",december:"12",dec:"12",des:"12"},$e=function(e){var t=e.replace(/DAY/g,"(0?[1-9]|[12][0-9]|3[01])").replace(/MONTHLONG/g,"("+s(Re).join("|")+")").replace(/MONTH/g,"(0?[1-9]|1[012])").replace(/YEAR2/g,"([0-9][0-9])").replace(/YEAR/g,"(197[1-9]|19[8-9][0-9]|20[0-9][0-9])").replace(/TIME/g,"([0-9][0-9]):([0-9][0-9]):([0-9][0-9])(?:\\.[0-9][0-9][0-9])?([zZ]|[+-][0-9][0-9](?::?[0-9][0-9])?)?"),n=e.replace(/.*?([YMD])(EAR|ONTH|AY).*?/g,"$1").substring(0,3);return[new RegExp(t),n]},Be=["\\bDAY\\.MONTH\\.YEAR\\b","\\bDAY\\.?\\s{0,3}MONTHLONG\\.?\\s{1,3}YEAR\\b","\\bYEAR-MONTH-DAY(?:[tT]|\\b)","\\bMONTHLONG\\.?\\s{0,3}DAY(?:st|nd|rd|th)?,?\\s{1,3}YEAR\\b","\\bDAY(?:st|nd|rd|th|\\.)?\\s{0,3}MONTHLONG\\.?,?\\s{1,3}YEAR\\b","\\bYEAR[/年]MONTH[/月]DAY(?=\\b|日)","\\bDAY\\.MONTH\\.YEAR2\\b","\\bDAY/MONTH/YEAR\\b"].map($e),Ve=$e("YEAR-MONTH-DAY[tT]TIME")[0],He=function(e){return e&&parseInt(e,10)||0};function Ye(e,t,n,r,i,o,u){var a=new Date(Date.UTC(He(e),He(t)-1,He(n),He(r),He(i),He(o))),s=(u||"").match(/^([+-][0-9][0-9])(?::?([0-9][0-9])?)$/);s&&(a=new Date(a.getTime()-36e5*Number(s[1])-6e4*(Number(s[2])||0)));var c=Date.now()-a.getTime();return c>0||-c<1728e5?a.toISOString():null}var Qe=function(e){return e.replace(/<\/?[^>?]*\/?>/g," ").replace(/\s+/g," ").trim()};function ze(e){return void 0===e&&(e=""),Qe(e.replace(/,(?=\s*(jr|sr)(\.?)\b)/g," "))}var Je,Ke=function(e){return i(i({},e),{take:"last"})},Ge=function(e){return i(i({},e),{take:"last",hasContent:!0,getContent:function(e){return Qe(e.content||"")}})},Xe=[Ke({attr:["name","property","itemprop"],names:["cxenseparse:publishtime","cxenseparse:recs:publishtime","article:published_time","date","dc.date","dc.date.created","dc.terms.issued","pub_date","article.published","datepublished","og:article:published_time"]}),Ke({selector:"time.published[datetime],time[pubdate][datetime]",getContent:function(e){return e.getAttribute("datetime")}}),Ke({selector:"time[datetime]",getContent:function(e){return e.getAttribute("datetime")}})],Ze={selector:'meta[property="article:modified_time"]'},et=[{attr:["property","name"],names:["cxenseparse:author","og:article:author","article:author","og:book:author","book:author","author","dc.creator","article.author"],take:"all",getContent:function(e){var t,n=e.getAttribute("data-separator"),r=e.content;return n?ze(r).split(n):(void 0===(t=r)&&(t=""),ze(t.replace(/\n+/,";").replace(/(\<|&lt;)br(\>|&gt;)/,";").replace(/\b(and|und|og)\b/g,";")).split(/[,;]/))}}],tt=[Ge({names:["cxenseparse:keywords"]}),Ge({attr:["property","name"],names:["news_keywords"]}),Ge({names:["keywords"]})],nt=[Ge({names:["cxenseparse:description"]}),Ge({attr:["property"],names:["og:description"]}),Ge({names:["description"]})],rt=[{names:["cxenseparse:title"]},Ke({attr:["property","name"],names:["og:title"]})],it=function(){var e,t=Array.from(document.querySelectorAll("meta[property^=content]")).reduce((function(e,t){var n,r=null===(n=null==t?void 0:t.getAttribute("property"))||void 0===n?void 0:n.split(":").pop(),i=Oe[r];return i&&t&&(e[r]=i((null==t?void 0:t.getAttribute("content"))||"")),e}),{});return Te.refresh(),Ue(e=t,"type",{attr:["property"],names:["og:type"]}),Ue(e,"section",qe("section")),Ue(e,"id",qe("id")),Ue(e,"authors",qe("author")),function(e){Ue(e,"createdAt",(function(){var e=Fe(Xe);return e?function(e){var t=(e=e.toLowerCase()).match(Ve);if(t)return Ye(t[1],t[2],t[3],t[4],t[5],t[6],t[7]);for(var n=0,r=Be;n<r.length;n++){var i=r[n],o=e.match(i[0]);if(o)return Ye(2===(o="DMY"===i[1]?["",o[3],o[2],o[1]]:"MDY"===i[1]?["",o[3],o[1],o[2]]:o)[1].length?(He(o[1])<60?"20":"19")+o[1]:o[1],o[2].length<=2?o[2]:Re[o[2]],o[3])}}(e.toLowerCase()):null})),Ue(e,"modifiedAt",Ze),Ue(e,"authors",et),Ue(e,"keywords",(function(){var e=Fe(tt);return e&&e.length<=1024?e:null})),Ue(e,"title",rt),Ue(e,"description",nt)}(t),t},ot=i(i({},u(null)),{init:function(){return it()},refresh:function(e){var t=it();return(null==e?void 0:e._fixed_)&&(null==e||e._fixed_.forEach((function(e){delete t[e]}))),i(i({},e),t)},set:function(e,t){if(null===e)return{};var n=new Set(t&&t._fixed_),r=function(t,n){s(g(e,t)).forEach(n)};return r(d,(function(e){n.add(e)})),r(l,(function(e){n.delete(e)})),g(i(i(i({},t),e),{_fixed_:Array.from(n.values())}),d)},get:w((function(e){var t=i({},e);return delete t._fixed_,e&&t}))}),ut=i(i({},o(null,"_pcus")),{init:function(e){return void 0===e&&(e=null),e&&g(e,(function(e){return f(e)&&Array.isArray(e.segments)}))}}),at={pageViewId:A,browserId:I,users:_,userStatus:a,siteId:o(),consent:Ee,consentPresets:Ce,products:Ae,consentModifiers:Ie,purposes:X,content:ot,userSegments:ut},st={path:"/",expires:395,samesite:"lax",secure:"https:"===window.location.protocol,domain:r.cookie.getTopLevelDomain(["pantheon.io","go-vip.net","go-vip.co"])},ct=function(e){return e.getTime().toString(36)},lt=function(e){return e?b((function(){return new Date(parseInt(e,36))})):null},dt="_t",ft="essential",pt="optional",vt="mandatory",gt=function(e,t,n){return void 0===t&&(t=pt),void 0===n&&(n=!1),{cookieName:e,consent:t,encode:function(e){return function(e,t){void 0===t&&(t=!1);var n=JSON.stringify(e);return b((function(){return t?window.btoa(n):n}))||n}(e,n)},decode:function(e){return P(e,!0)}}},mt=String.fromCharCode,ht="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",wt={};!function(e){e.URI="URI"}(Je||(Je={}));var yt,bt,Pt,St,kt={URI:{prefix:"{u}",compress:function(e){return null==e?"":function(e,t,n){if(null==e)return"";var r,i,o,u={},a={},s="",c="",l="",d=2,f=3,p=2,v=[],g=0,m=0;for(o=0;o<e.length;o+=1)if(s=e.charAt(o),Object.prototype.hasOwnProperty.call(u,s)||(u[s]=f++,a[s]=!0),c=l+s,Object.prototype.hasOwnProperty.call(u,c))l=c;else{if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(r=0;r<p;r++)g<<=1,5==m?(m=0,v.push(n(g)),g=0):m++;for(i=l.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&i,5==m?(m=0,v.push(n(g)),g=0):m++,i>>=1}else{for(i=1,r=0;r<p;r++)g=g<<1|i,5==m?(m=0,v.push(n(g)),g=0):m++,i=0;for(i=l.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&i,5==m?(m=0,v.push(n(g)),g=0):m++,i>>=1}0==--d&&(d=Math.pow(2,p),p++),delete a[l]}else for(i=u[l],r=0;r<p;r++)g=g<<1|1&i,5==m?(m=0,v.push(n(g)),g=0):m++,i>>=1;0==--d&&(d=Math.pow(2,p),p++),u[c]=f++,l=String(s)}if(""!==l){if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(r=0;r<p;r++)g<<=1,5==m?(m=0,v.push(n(g)),g=0):m++;for(i=l.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&i,5==m?(m=0,v.push(n(g)),g=0):m++,i>>=1}else{for(i=1,r=0;r<p;r++)g=g<<1|i,5==m?(m=0,v.push(n(g)),g=0):m++,i=0;for(i=l.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&i,5==m?(m=0,v.push(n(g)),g=0):m++,i>>=1}0==--d&&(d=Math.pow(2,p),p++),delete a[l]}else for(i=u[l],r=0;r<p;r++)g=g<<1|1&i,5==m?(m=0,v.push(n(g)),g=0):m++,i>>=1;0==--d&&(d=Math.pow(2,p),p++)}for(i=2,r=0;r<p;r++)g=g<<1|1&i,5==m?(m=0,v.push(n(g)),g=0):m++,i>>=1;for(;;){if(g<<=1,5==m){v.push(n(g));break}m++}return v.join("")}(e,0,(function(e){return ht.charAt(e)}))},decompress:function(e){return null==e?"":""==e?null:function(e,t,n){var r,i,o,u,a,s,c,l=[],d=4,f=4,p=3,v="",g=[],m={val:n(0),position:t,index:1};for(r=0;r<3;r+=1)l[r]=r;for(o=0,a=Math.pow(2,2),s=1;s!=a;)u=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(u>0?1:0)*s,s<<=1;switch(o){case 0:for(o=0,a=Math.pow(2,8),s=1;s!=a;)u=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(u>0?1:0)*s,s<<=1;c=mt(o);break;case 1:for(o=0,a=Math.pow(2,16),s=1;s!=a;)u=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(u>0?1:0)*s,s<<=1;c=mt(o);break;case 2:return""}for(l[3]=c,i=c,g.push(c);;){if(m.index>e)return"";for(o=0,a=Math.pow(2,p),s=1;s!=a;)u=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(u>0?1:0)*s,s<<=1;switch(c=o){case 0:for(o=0,a=Math.pow(2,8),s=1;s!=a;)u=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(u>0?1:0)*s,s<<=1;l[f++]=mt(o),c=f-1,d--;break;case 1:for(o=0,a=Math.pow(2,16),s=1;s!=a;)u=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(u>0?1:0)*s,s<<=1;l[f++]=mt(o),c=f-1,d--;break;case 2:return g.join("")}if(0==d&&(d=Math.pow(2,p),p++),l[c])v=l[c];else{if(c!==f)return null;v=i+i.charAt(0)}g.push(v),l[f++]=i+v.charAt(0),i=v,0==--d&&(d=Math.pow(2,p),p++)}}((e=e.replace(/ /g,"+")).length,32,(function(t){return function(e,t){if(!wt[e]){wt[e]={};for(var n=0;n<e.length;n++)wt[e][e.charAt(n)]=n}return wt[e][t]}(ht,e.charAt(t))}))}}},_t=s(kt).reduce((function(e,t){return e[kt[t].prefix]=kt[t],e}),{}),Et={cookieName:"_pctx",consent:vt,encode:function(e,t){void 0===t&&(t=Je.URI);var n=JSON.stringify(e),r=kt[t].compress(n);return kt[t].prefix+r},decode:function(e){var t=function(e){var t=e.slice(0,3),n=e.slice(3);if(!_t[t])return null;var r=_t[t].decompress(n);if(!r)return null;try{return JSON.parse(r)}catch(e){return null}}(e||"");return f(t)?t:null}},Ct={_pprv:gt("_pprv",vt,!(null===(bt=null===(yt=E().cookies)||void 0===yt?void 0:yt._pprv)||void 0===bt?void 0:bt.jsonOnly)),_pcid:gt("_pcid",ft),_pcus:gt("_pcus",pt,!0),_pctx:Et},At=function(e){return s(e).reduce((function(t,n){return t[n]=function(e){var t=e.cookieName,n=e.consent,o=r.cookie.get(t),u=!!o,a=u,s=function(e,t){var n=t.encode,r=t.decode,o=!1,u=null,a=null,s=null;!function(){var t,n=null===(t=r(e||""))||void 0===t?void 0:t[dt];if(n){var i=n.split("|");u=lt(i[0]),a=lt(i[1]),o=!!u}}();var c=function(e){return u=u||function(e){var t=new Date;if(e instanceof Date)t=e;else{if("number"!=typeof e)return null;t.setDate(t.getDate()+e)}return t}(e.expires)};return{get fixedAt(){return o?[a,u]:null},onChange:function(e){s=e},setMode:function(e){var t=o;(o=e)!==t&&(u=null,a=null,null==s||s(o))},bindOptions:function(e){return o&&(u=c(e))?i(i({},e),{expires:u}):e},decode:function(e){var t=r(e);return(null==t?void 0:t[dt])&&delete t[dt],t},encode:function(e,t){return o?(u=c(t))&&(e[dt]=ct(u)+"|"+ct(a=a||new Date)):delete e[dt],n(e)}}}(o,e),c=!!s.fixedAt,l=u,f=null,p=i({},st),v=null,m=function(){return u&&l},h=function(e){var n=w(e),i=f||(v?s.encode(v,n):"");if(!i){var o=r.cookie.get(t),u=s.decode(o||"");i=u?s.encode(u,n):""}i&&(c=!0,r.cookie.set(t,i,s.bindOptions(n)),a=!0)},w=function(e){return i(i({},p),g(e||{},d))},y=function(e){m()&&(a&&r.cookie.remove(t,w(e)),a=!1)},b=function(e,t){var n=e&&t;!m()&&n&&h(),m()&&!n&&y(),m()&&n&&!c&&h(),u=e,l=t};return s.onChange((function(){m()&&(c=!1,h())})),{get cookieName(){return t},get cookieEnabled(){return m()},get fixedAt(){return s.fixedAt},get consent(){return n},set:function(e,t){v=e,m()&&h(t)},get:function(){return s.decode(r.cookie.get(t)||"")},remove:y,setCookieOptions:function(e){p=w(e),m()&&h()},setCookieEnabled:function(e,t){void 0===t&&(t=null),f=e?t:null,b(e,l)},lazyActive:function(){b(u,!0)},setFixedMode:function(e){s.setMode(e)}}}(e[n]),t}),{})}(Ct),It="__pctx_connection__",Dt="uvm42pas28m",Nt={},jt=function(){var e,t,n=(e=null,t=null,{register:function(n){return e=i(i({},n.fields),e),t=i(i({},n.cookieByName),t)},get wrappers(){return t},get:function(){var e={};return t&&s(t).forEach((function(n){e=i(i({},e),t[n].get())})),e},set:function(n,r){void 0===r&&(r=null);var i={};s(n).forEach((function(o){var u=n[o],a=null==e?void 0:e[o];a&&(i[a]||(i[a]={wrapper:null==t?void 0:t[a],data:{},update:!1,remove:!0}),i[a].data[o]=u,i[a].remove=i[a].remove&&null===u,r&&(i[a].update||u===r[o])||(i[a].update=!0))})),s(i).forEach((function(e){var t=i[e],n=t.wrapper,r=t.update,o=t.remove;o&&n.remove(),r&&!o&&n.set(i[e].data)}))}}),r={},o=null,u=new Map,a=new Map,c=[],l=function(e,t,n){void 0===n&&(n=!1);var r=[];return s(t).forEach((function(i){var o=t[i],u=!a.has(i)||a.get(i)===e||n;o&&u?a.set(i,e):!o&&u?a.delete(i):r.push(i)})),r.length>0?r:null};return function(e,t){var d=v();return u.set(d,e),t&&n.register(t),r=i(i({},n.get()),r),{getInitCookieData:function(){return r},getCachedData:function(){return o||Nt},setProtectionData:function(e){return l(d,e)},setProtectionDataUnsafe:function(e){return l(d,e,!0)},updateData:function(e){return function(e,t){var u={},l={};s(t).forEach((function(e){a.has(e)?u[e]=(null==o?void 0:o[e])||null:l[e]=t[e]}));var d=o||r,f=i(i({},o),l);return S(f,d)||(n.set(f,d),o=f,c.forEach((function(e){return(0,e[1])(l)}))),s(u).length>0?u:null}(0,e)},onUpdateData:function(e){!function(e,t){c.push([e,t])}(d,e)},terminate:function(){var e;e=d,c=c.filter((function(t){return t[0]!==e})),u.delete(d)},setCookieOptions:function(){return null},setCookieEnabled:function(){return null},get registeredCookiesWrapper(){return n.wrappers}}}},Ot=(void 0===Pt&&(Pt=!1),function(e,t){var n=jt();try{Object.defineProperty(window,It,{configurable:Pt,set:function(e){var t=e();t===Dt?e(n):"mrlqf5trgho"===t&&(n=jt())}})}catch(e){}return window[It]=function(e){return e&&(n=e),Dt},n(e,t)}),xt=function(e){return e.includes("*")},Wt=function(e,t){return[new RegExp("^"+e.replace(/\*/g,".*")+"$"),t]},Mt=function(e){return s(e).filter(xt).map((function(t){return Wt(t,e[t])}))},Tt=function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i[0].test(e))return i[1]}return null},Lt=function(e,t){switch(e){case F:return!0;case U:return t===ft||t===vt;case q:return t===vt;default:return!0}},Ft=function(e){switch(e){case"include":case"obfuscate":return!0;case"exclude":return!1}},Ut=function(e){var t=Object.assign({},e.items),n=Mt(t),r=function(e){return t[e]||Tt(e,n)||pt};return function(t,n){var i=E().requireConsent,o=!c(t),u=o?[t]:t,a=function(){var t=function(){return u.map((function(e){return{name:e,allowed:!i}}))},o=n||e.getConsent();if(!o)return t();if(o.mode===R){var a=function(e,t,n){var r=t&&me(t,n);if(!r)return null;for(var i=[],o={},u=0,a=r.patches;u<a.length;u++){var s=a[u],c=s.action,l=s.with,d=void 0===l?null:l,f=s.item;if(f.type===e){var p={action:c,data:d};o[f.key]=p,xt(f.key)&&i.push(Wt(f.key,p))}}return{source:r.source,getModifier:function(e){return o[e]||Tt(e,i)}}}(e.type,o.modifier,e.log);if(!a)return t();var s=a.source;return u.map((function(e){var t=a.getModifier(e),n=function(e,t){return"obfuscate"===e?t:null}(null==t?void 0:t.action,null==t?void 0:t.data),i={name:e,allowed:(null==t?void 0:t.action)?Ft(t.action):Lt(s,r(e))};return null!==n&&(i.data=n),i}))}return u.map((function(e){return{name:e,allowed:Lt(o.mode,r(e))}}))}();return o?a[0]:a}},qt=Object.freeze({__proto__:null,createCheckConsentWrapper:Ut,createMask:Wt,getByMask:Tt,isMask:xt,itemsToMask:Mt}),Rt=function(e){var t=e&&e.length;return 16===t||36===t?e:null},$t=(St={pa_vid:function(e){return Rt(P(e||"",!0)||e)},atuserid:function(e){var t;return Rt((null===(t=P(e||"",!0))||void 0===t?void 0:t.val)||"")}},function(e){for(var t=function(e){try{var t=function(){if(e.ls)return function(e){var t=function(e){return b((function(){return window.localStorage.getItem(e)}))},n=t(e),r=b((function(){return parseInt(P(t("_ls_ttl"))[e],36)}));return r&&r<=Date.now()?null:n}(e.ls)||null;var t=r.cookie.get(e);return St[e]&&t?St[e](t):t}();if(t)return{value:t}}catch(e){}},n=0,i=e;n<i.length;n++){var o=t(i[n]);if("object"==typeof o)return o.value}return null}),Bt=[{ls:"_cX_P"},"cX_P"],Vt={PA:{browserId:["pa_vid","atuserid"].concat(Bt)},DMP:{browserId:Bt}},Ht={browserId:{source:"DMP"}},Yt=function(e){var t,n=i(i({},Ht),function(e,t){return void 0===t&&(t=fe),s(e||{}).reduce((function(n,r){var o=null==e?void 0:e[r],u=ve((null==o?void 0:o.source)||"",t);return n[r]=i(i({},o),{source:u}),n}),{})}(null===(t=E())||void 0===t?void 0:t.migration));s(n).forEach((function(t){var r,i,o=e.params.get(t),u=n[t]===Ht[t],a=null===(r=n[t])||void 0===r?void 0:r.source,s=a&&(null===(i=Vt[a])||void 0===i?void 0:i[t])||[];if(o&&s.length){var c=$t(s);c&&(o.readonly=!1,e.updateValues(t,c,!0),o.readonly=!u)}}))},Qt="@@Data-layer/",zt=Qt+"update_value",Jt=Qt+"refresh_value",Kt=Qt+"refresh_locked_key",Gt=function(e,t,n){var r=1===n?"can not be":"was";console.warn('[DL]: Consent v2: the "'.concat(e,'" has a conflicted consent mode, ')+"mode ".concat(r,' changed to "').concat(t,'"'))},Xt=function(e,t,n){var r,o=function(e,t){return{fields:s(e).reduce((function(t,n){var r=e[n].cookieName;return null!==r&&(t[n]=r),t}),{}),cookieByName:t}}(e,t),u=Ot("data-layer",o),a=!1,l=new Map,v=new Set,g=new Map,w=function(){if(!u)throw new Error("DataLayer can't be connected");return u},y=function(e){var t=w().registeredCookiesWrapper;t&&e(t)},b=function(e){y((function(t){e.forEach((function(e){var n=t[e];n&&n.lazyActive()}))}))},P=function(){var e=null;return y((function(t){e=s(t).reduce((function(e,n){var r=t[n].cookieEnabled,i=t[n].fixedAt||null;return e[t[n].cookieName]=r?{enabled:r,fixedAt:i}:null,e}),{})})),e},S=function(){var e={},t=function(t){return s(e).reduce((function(n,r){var i=e[r];return void 0!==i[t]&&(n[r]=i[t]),n}),{})};return{add:function(t,n){e[t]=n},call:function(){var e;e=t("protect"),s(e).length>0&&w().setProtectionData(e),function(){var e=t("protectUnsafe");s(e).length>0&&w().setProtectionDataUnsafe(e)}()}}},k=function(e,t){return s(e).reduce((function(n,r){var i=g.get(r),o=e[r];return i&&(n[r]=t?t(i,o):i.get(o)),n}),{})},_=function(){return{params:g,getConnection:w,addChangeListener:N,get:C,updateValues:E}},E=function(e,t,n){var o;void 0===n&&(n=!1);var u=e,a=m();p(e)&&((o={})[e]=t,u=o);var c=S(),l=S();u=s(u).reduce((function(e,t){var n=u[t],i=g.get(t),o=t;return(null==i?void 0:i.readonly)?e:(i&&i.cookieName&&a.add(i.cookieName),i&&n!==r[t]?n===Jt?(e[t]=i.refresh(r[t],(function(e){l.add(o,e)})),e[t]!==r[t]&&c.add(o,{protectUnsafe:!1}),e):n===zt?(e[t]=i.update(r[t],(function(e){l.add(o,e)})),e):(e[t]=i.set(n,r[t],(function(e){l.add(o,e)})),e):e)}),{}),b(a.values()),c.call();var d=w().updateData(u);if(d&&n){var f=s(d).reduce((function(e,t){var n;return i(i({},e),((n={})[t]=!1,n))}),{});w().setProtectionDataUnsafe(f),w().updateData(u)}return l.call(),d&&k(d)};function C(e){var t,n,i=m(),o=p(e);return void 0===e?n=r:o?((t={})[e]=r[e],n=t):n=e.reduce((function(e,t){return g.has(t)&&(e[t]=r[t]),e}),{}),n=k(n,(function(e,t){return e.cookieName&&i.add(e.cookieName),e.get(t)})),b(i.values()),o?n[e]:n}function A(e,t){return E(e,t,!1)}var I=function(e,t){void 0===t&&(t=!1);var n=e;return c(e)||(n=[e]),E(n.reduce((function(e,t){return e[t]=zt,e}),{}),void 0,t)},D=function(e,t,n){var r;void 0===n&&(n=!1);var i=n?w().setProtectionDataUnsafe:w().setProtectionData,o=e;return p(e)&&((r={})[e]=t,o=r),i(o)};function N(e,t){var n;p(e)?null===(n=l.get(e))||void 0===n||n.add(t):v.add(e)}return{init:function(t){if(void 0===t&&(t={}),!a){var c,d;u||(u=Ot("data-layer",o)),c=i(i({},t),(A=i({},window.pdl),I=function(e){return t=e,n={path:String,domain:String,secure:h,expires:function(e){return e instanceof Date?e:Number(e)},samesite:function(e){return p(e)?e:h(e)}},f(t)?s(t).reduce((function(e,r){var i=t[r],o=n[r],u=o&&o(i);return void 0!==u&&(e[r]=u),e}),{}):t;var t,n},(null==A?void 0:A.cookies)&&(A.cookies=s(A.cookies).reduce((function(e,t){return e[t]=I(A.cookies[t]),e}),{})),(null==A?void 0:A.cookieDefault)&&(A.cookieDefault=I(A.cookieDefault)),A)),d=c.cookieDefault,y((function(e){s(e).forEach((function(t){var n,r,o,u,a=e[t].cookieName,s=null===(n=c.cookies)||void 0===n?void 0:n[a],l="fixed"===(null===(r=c.cookies)||void 0===r?void 0:r.storageMode);null===(u=(o=e[t]).setFixedMode)||void 0===u||u.call(o,l),(d||s)&&e[t].setCookieOptions(i(i({},d),s))}))})),a=!0,s(e).forEach((function(t){var n=e[t];l.set(t,new Set),g.set(t,n)}));var m=!1,b=w().getInitCookieData(),P=w().getCachedData(),E=S(),C=s(e).reduce((function(t,n){var r=n,i=e[n];return t[n]=(null==P?void 0:P[r])||i.init(null==b?void 0:b[r],(function(e){E.add(r,e)})),(null==P?void 0:P[r])||(m=!0),t}),{});r=C,m&&w().updateData(C),E.call(),w().onUpdateData((function(e){return function(e){var t=!1;s(e).forEach((function(n){var i,o=n,u=g.get(o);if(u){var a=e[o];r[o]!==a&&(r[o]=a,t=!0,null===(i=l.get(o))||void 0===i||i.forEach((function(e){return e(u.get(a))})))}})),t&&v.forEach((function(e){return e(k(r))}))}(e)})),null==n||n(_())}var A,I},set:A,get:C,update:function(e){return I(e)},refresh:function(){var e;if(w().setProtectionData(((e={})[Kt]=!0,e)))return!1;var t=[];g.forEach((function(e,n){return t.push(n)}));var n=t.reduce((function(e,t){return e[t]=Jt,e}),{});return E(n),!0},protect:function(e,t){return D(e,t)},addChangeListener:N,removeChangeListener:function(e){v.delete(e),l.forEach((function(t){return t.delete(e)}))},terminate:function(){null==u||u.terminate(),l.clear(),v.clear(),u=null,a=!1,r={}},updateMigration:function(){a&&Yt(_())},get isReady(){return a},utils:{validateModifier:me,validateConsent:he,checkConsent:qt,setConsent:function(e,t,n){C("consent");var r=function(e,t,n,r,i){var o=function(e){return{error:e}},u=function(t,n,r){var i=[];if(!Y(t))return o(function(e){return"".concat(e," is unknown consent mode")}(t));var u=W().reduce((function(o,u){var a=u.id,s=u.name;return n&&(null==e?void 0:e[a])!==n&&!(null==r?void 0:r.includes(a))||(ne(t,s)?i.push(s):o[a]={mode:t}),o}),{});return i.length?o(function(e){return ae(e,"does","do")+"n't have modifier in the pdl. Custom mode can't be applied"}(i)):Object.keys(u).length?{consent:u}:null},a=function(t,n){var r=ue(n);return ie[r]||Object.values(e||{}).includes(r)?u(t,r):o("Unknown purpose. Provide a product or define within pdl config")};return te()?i?function(e,t,n){var r=ue(t),i=c(n)?n:[n],s=i.map(T).filter(d);if(!s.length)return oe(t)?a(e,t):o(function(e){return"Custom purpose: "+ae(e,"is","are")+" unknown"}(i));if(r!==re&&s.includes(j.DL))return{error:se(r)};if(r===re&&s.some((function(e){return e!==j.DL})))return o('the "DL" purpose is reserved');var l=u(e,r,s);if(null==l?void 0:l.error)return l;var f=s.reduce((function(e,t){return e[t]=r,e}),{});return{consent:(null==l?void 0:l.consent)||null,purposes:f}}(r,n,i):r?a(r,n):u(n):o("Consent v2 is disabled")}(C("purposes"),0,e,t,n);return r?r.error?r.error:(A({consent:r.consent,purposes:r.purposes}),null):null},getConsent:function(){var e=C(["consent","purposes"]),t=e.consent,n=e.purposes;return ce(t,n)},notAcquiredConsent:te()?s(Q).reduce((function(e,t){return e[t]={mode:"not-acquired",products:Q[t]},e}),{}):null},get cookies(){return P()},get cookieEnabled(){return P()},setUnsafe:function(e,t){E(e,t,!0)},protectUnsafe:function(e,t){return D(e,t,!0)},updateUnsafe:function(e){return I(e,!0)},setCookieEnabled:function(e){y((function(t){var n=s(e);n.length?n.forEach((function(n){var r=t[n];r&&r.setCookieEnabled(e[n])})):s(t).forEach((function(n){t[n].setCookieEnabled(e)}))}))}}}(at,At,(function(e){!function(e){var t,n=s(Ct).reduce((function(e,t){return e[t]=Ct[t].consent,e}),{}),r=function(t){var n;return t||(null===(n=e.get("consent"))||void 0===n?void 0:n.DL)||null},i=Ut({items:n,type:"cookie",getConsent:r}),o=r(),u=(null===(t=e.get("consent"))||void 0===t?void 0:t.PA)||null,a=function(t,n){var r,o=function(e){var t=function(e){var t,n,r=E(),i=(null===(t=r.consent)||void 0===t?void 0:t.products)||[],o=1===i.length&&"PA"===i[0],u="opt-out"===(null===(n=null==e?void 0:e.PA)||void 0===n?void 0:n.mode);return!!r.requireConsent&&o&&u}(e);return{_pprv:!E().requireConsent,_pctx:t,_pcid:t,_pcus:t}}(n),u=null===(r=e.getConnection())||void 0===r?void 0:r.registeredCookiesWrapper;if(u){var a=s(u).map((function(e){return u[e].cookieName}));i(a,t).forEach((function(e){var t=e.name,n=e.allowed,r=e.data,i=t,a=n&&!o[i];u[i].setCookieEnabled(a,r||null)}))}};e.addChangeListener("consent",(function(e){var t=(null==e?void 0:e.DL)||null,n=(null==e?void 0:e.PA)||null;(null==o?void 0:o.mode)===(null==t?void 0:t.mode)&&(null==u?void 0:u.mode)===(null==n?void 0:n.mode)||(o=t,u=n,a(t,e))})),a(o,e.get("consent"))}(e),Yt(e),function(e){var t=null,n={},r=function(t){var r=ce(t,e.get("purposes"));if(r&&t){var i=!1,o=s(r).reduce((function(e,o){var u=r[o].mode;return r[o].products.forEach((function(r){var o;u!==(null===(o=t[r])||void 0===o?void 0:o.mode)&&(ne(u,r)?n[r]||(n[r]=!0,Gt(r,u,1)):(e[r]={mode:u},i=!0,Gt(r,u,2)))})),e}),{});i&&e.updateValues({consent:o})}};e.addChangeListener("consent",(function(e){te()&&(t&&(clearTimeout(t),t=null),t=setTimeout((function(){r(e),t=null}),200))})),te()&&r(e.get("consent"))}(e)}))},522:(e,t,n)=>{n.r(t),n.d(t,{cookie:()=>d,localStorage:()=>f,sessionStorage:()=>p});var r,i,o,u,a,s=function(e){var t=new Date,n=function(e){e&&t.setDate(t.getDate()+e)};if(e instanceof Date)t=e;else if("number"==typeof e)n(e);else{var r=e,i=r.days,o=r.minutes;n(i),o&&t.setMinutes(t.getMinutes()+o)}return t},c=function(e){var t=e.replace(/\+/g," ").replace(/^\s+|\s+$/g,"");try{return decodeURIComponent(t)}catch(e){return t}},l=function(e){return 0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),c(e)},d=function(){var e=function(e,t,n){var r=void 0===n?{}:n,i=r.path,o=r.domain,u=r.expires,a=r.secure,c=r.samesite,l=r.raw,d=r.priority;return(l?e:encodeURIComponent(e))+"="+(l?t:encodeURIComponent(t))+(u?"; expires=".concat(s(u).toUTCString()):"")+(i?"; path=".concat(i):"")+(o?"; domain=".concat(o):"")+(a?"; secure":"")+(c?"boolean"==typeof c?"; sameSite":"; sameSite=".concat(c):"")+(d?"; priority=".concat(d):"")},t=function(t,n,r,i){void 0===n||void 0!==i&&encodeURI(n).split(/%(?:u[\dA-F]{2})?[\dA-F]{2}|./).length-1>i||(document.cookie=e(t,n,r))},n=function(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var r=t[n].split("=");if(e(c(r[0]),r[1]||""))return}};function r(e){var t=null,r={};return n((function(n,i){if(e){if(n===e)return t=l(i),!0}else r[n]=l(i)})),e?t:r}var i,o,u=function(e,n){t(e,"",Object.assign({},n,{expires:-1}))},a=(i="_cookie_test",o="https:"===document.location.protocol,function(e){void 0===e&&(e=[]);var n=window.location.hostname.split("."),a=(new Date).getTime().toString(36)+Math.round(2147483647*Math.random()).toString(36),s=new Date;s.setSeconds(s.getSeconds()+30);for(var c=0;c<n.length;c++)try{var l=n.slice(-(c+1)).join(".");if(!e.includes(l)){t(i,a,{expires:s,path:"/",domain:l,secure:o});var d=r(i)===a;if(u(i,{path:"/",domain:l}),d)return l}}catch(e){}});return{set:t,get:r,getNames:function(){var e=[];return n((function(t){e.push(t)})),e},remove:u,getTopLevelDomain:a,__private__:{_generateCookieString:e}}}(),f=(r="_ls_ttl",i=function(){try{var e=window.localStorage.getItem(r);return e?JSON.parse(e):null}catch(e){return null}},o=function(e){try{Object.keys(e).length?window.localStorage.setItem(r,JSON.stringify(e)):window.localStorage.removeItem(r)}catch(e){}},u=function(){var e=a(),t=i(),n={};t&&(Object.keys(t).forEach((function(r){var i;if(e.includes(r))if(!(i=t[r]?parseInt(t[r],36):null)||i>Date.now())n[r]=t[r];else try{window.localStorage.removeItem(r)}catch(e){}})),JSON.stringify(t)!==JSON.stringify(n)&&o(n))},a=function(){try{return Object.keys(window.localStorage)}catch(e){return[]}},u(),{get:function(e){var t;u();try{return null!==(t=window.localStorage.getItem(e))&&void 0!==t?t:null}catch(e){return null}},set:function(e,t,n){if(void 0===n&&(n={}),function(e,t){var n=i();if(void 0===t)return(null==n?void 0:n[e])&&(delete n[e],o(n)),!0;var r=s(t).getTime();return r>Date.now()&&((n=n||{})[e]=r.toString(36),o(n),!0)}(e,n.expires))try{window.localStorage.setItem(e,t)}catch(e){}},getNames:a,remove:function(e){try{window.localStorage.removeItem(e)}catch(e){}u()},expires:u,__protected__:{get ttlName(){return r}}}),p={get:function(e){try{return window.sessionStorage.getItem(e)}catch(e){return null}},set:function(e,t){try{window.sessionStorage.setItem(e,t)}catch(e){}},getNames:function(){try{return Object.keys(window.sessionStorage)}catch(e){return[]}},remove:function(e){try{window.sessionStorage.removeItem(e)}catch(e){}}}}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e=i(850),t=i(400),function(n,r){var i=["click","load","recsloaded","proxyload","widgetinit"],o="gaPianoESP",u="PianoESP",a="PianoESPConfig",s="PianoESP",c="pnespid",l=Number(new Date),d=!1;var f=new function(e,t){var n={mark:"[sdk]",messages:[]};function r(r){var i=function(){};return"function"==typeof e[r]?i=e[r]:"function"==typeof e.log&&(i=e.log.bind(e,r.toUpperCase()+" |")),function(){var o=Array.prototype.slice.call(arguments),u=[Date.now(),r].concat(o);if(n.messages.push(u),t&&e){var a=[n.mark].concat(o);i.apply(e,a)}}}return n.info=r("info"),n.warn=r("warn"),n.error=r("error"),n}(console,d);f.info("Started");var p=new function(r){var d,f={v:4},v=f.DEBUG=r.DEBUG;return f.config=r.config,f.started=r.started,f.logger=r.logger,f.log=r.logger.info,f.logi=r.logger.info,f.logw=r.logger.warn,f.loge=r.logger.error,f.window=r.window,f.document=r.window.document,f.API_HOST=r.apiHost,f.STATIC_HOST=r.staticHost||r.apiHost,f.NAMESPACE=r.namespace,f.widgetImplementations={},f.widgets=[],f.ALREADY_SUBSCRIBED="ALREADY_SUBSCRIBED",f.CLOSE_BUTTON_CLICK="CLOSE_BUTTON_CLICK",f.SUBSCRIBED="SUBSCRIBED",f.SUBSCRIPTION_FAILED="SUBSCRIPTION_FAILED",f._cachedFn=function(e,t){var n;function r(r){var i=null;try{i=t?f.stringify(r):f.stringify(arguments)}catch(e){}return null===i?e.apply(this,arguments):(i in n||(n[i]=e.apply(this,arguments)),n[i])}return r.reset=function(){n={}},r.reset(),r},f.$=function(){var e=f[f._jqholdername];return"function"!=typeof e?f.loge("Call `attachJquery` and ensure its execution is finished."):arguments.length>0?e.apply(e,arguments):e},f.attachGAPromise=function(){return f.getFusionDataPromise().then((function(e){var t,n,r,i,u,a,s=e.gaid;if(!s)return!1;t=f.window,n=document,r="script",i=o,t.GoogleAnalyticsObject=i,t[i]=t[i]||function(){(t[i].q=t[i].q||[]).push(arguments)},t[i].l=1*new Date,u=n.createElement(r),a=n.getElementsByTagName(r)[0],u.async=1,u.src="//www.google-analytics.com/analytics.js",a.parentNode.insertBefore(u,a);var c={trackingId:s,cookieDomain:"auto"};return e.gaparams&&e.gaparams.sample_rate&&(c.sampleRate=e.gaparams.sample_rate),f.window[o]("create",c),f.window[o]("require","displayfeatures"),f.window[o]("send","pageview"),!0})).then((function(e){return f.logi("attachGAPromise finished with:",f.nowStr(),{added:e}),e})).error((function(e){return f.loge("attachGAPromise failed with:",e),!1}))},f.attachJquery=function(e){function t(t,n){if(f.logi("jQuery has been loaded:",n),f._jqholdername="_jq"+Math.random()+":"+l,f[f._jqholdername]=t,v&&(f.window.$=f.window.jQuery=f.window.jQuery||f.window.$||t),!f.API_HOST||"string"!=typeof f.API_HOST){var r=f.getSdkScript(),i=r.prop("src");if(!i)return f.loge('No SDK script tag or wrong "src":',r[0],i),f;f.API_HOST=f.getOrigin(i)}f.STATIC_HOST&&"string"==typeof f.STATIC_HOST||(f.STATIC_HOST=f.API_HOST),e()}function n(){return f.window.jQuery&&f.window.jQuery.fn&&"function"==typeof f.window.jQuery.fn.on&&"function"==typeof f.window.jQuery.fn.find&&"function"==typeof f.window.jQuery.fn.prop}function r(e){var n=f.window.jQuery,r=f.document.createElement("script");r.type="text/javascript",r.src="//code.jquery.com/jquery-2.2.0.min.js",r.async=!0,r.onload=function(){var r=f.window.jQuery.noConflict(!0);f.window.jQuery=n,t(r,e)},f.document.getElementsByTagName("head")[0].appendChild(r)}f.window.jQuery?n()?t(f.window.jQuery,"existing in app.window"):function(e,t){var r=!0;"function"==typeof f.window.jQuery&&f.window.jQuery((function(){n()&&(r&&e(f.window.jQuery,"recovered from existing faked instance as app.window.jQuery function"),u())}));var i=10,o=setInterval((function(){if(r)return n()?(e(f.window.jQuery,"recovered from existing faked instance as app.window.jQuery object"),void u()):void(--i<=0&&(t("our instance after recovery attempt"),u()));u()}),500);function u(){clearInterval(o),o=null,r=!1}}(t,r):r("our instance")},f.copyAttributes=function(e,t){var n=f.$(e),r=f.$(t||{}),i=n.prop("attributes");return f.$().each(i,(function(){r.attr(this.name,this.value)})),r[0]},f.createWidgetPromise=function(e,t,n){var r=!1;return f.verifyWidgetShouldBeShownPromise(e,t,n).then((function(){var t=f.isString(e.type,1),n=f.isString(f.get(e,"custom.displayer"),1);if(!t&&!n)return f.reject("Widget displayer is not specified");var i=[],o=f.resolve(!1);e.behavior.skip_base_implementation||i.push(f.loadWidgetImplementation("predefined","base").then((function(t){return f.isFunction(t)||(f.loge("createWidgetPromise","Base widget implementation",f.stringify(e.type),"has not been loaded:",t),r=!0),t}))),t&&(i.push(f.loadWidgetImplementation("predefined",e.type).then((function(t){return f.isFunction(t)||(f.loge("createWidgetPromise","Predefined widget implementation",f.stringify(e.type),"has not been loaded:",t),r=!0),t}))),f.get(e,"view.iframe_resizer_is_needed")&&(o=f.loadScriptPromise(f.STATIC_HOST+"/public/sdk/vx/lib/iframeResizer/iframeResizer.min.js"))),n&&i.push(f.loadWidgetImplementation("custom",e.custom.displayer).then((function(t){return f.isFunction(t)||(f.loge("createWidgetPromise","Custom widget implementation",f.stringify(e.custom),"has not been loaded:",t),r=!0),t})));var u=f.resolve(!1);return e.behavior.skip_state_machine_code||(u=f.loadScriptPromise(f.STATIC_HOST+"/public/sdk/vx/lib/state-machine/state-machine.min.js")),f.join(f.Promise.all(i),o,u)})).spread((function(t){if(r)return null;for(var i=function(){},o=0,u=t.length;o<u;o++)try{i=t[o](i,f.inherits,f)}catch(e){return f.loge("createWidgetPromise:","can't inherit",e),null}try{var a=new i(e,n);return f.logi(a.getMyName(),a),a}catch(e){return f.loge("createWidgetPromise:","can't construct",e),null}})).error((function(t){return f.logw("createWidgetPromise","Widget",e.id||e,"is skipped because",t),null}))},f.EventEmitter=function(){function e(){if(!(this instanceof e))return new e;this.events={}}return e.prototype.emit=function(e,t){this.events["*"]&&this._emit("*",{eventName:e,data:t}),this._emit(e,t)},e.prototype._emit=function(e,t){for(var n in this.events)if(n===e||n.split(".").indexOf(e)>-1){var r=this.events[n];if(!f.$().isArray(r))continue;f.$().each(r,(function(n,r){try{r(t)}catch(n){f.loge("EventEmitter::emit failed",e,t,n,r)}}))}},e.prototype.off=function(e,t){var n=!f.isFunction(t);if(!e||"string"!=typeof e)return!1;var r=!1;for(var i in this.events)if(i===e||i.split(".").indexOf(e)>-1){if(!f.$().isArray(this.events[i]))continue;this.events[i]=f.$().grep(this.events[i],(function(e){return r=n||e===t}))}return r},e.prototype.on=function(e,t){if(!f.isFunction(t))throw new Error('EventEmitter::on("'+e+'", fn) second argument must be function, but passed: '+f.stringify(t));f.$().isArray(this.events[e])||(this.events[e]=[]),this.events[e].push(t);var n=this;return function(){return n.off(e,t)}},e}(),f.exposePublicApi=function(e){f.$().isPlainObject(e)||f.isFunction(e)||(e=f.publicApi),e.getCurrentPushState=f.getCurrentPushStatePromise,e.getShownWidgets=f.getShownWidgets,e.getVisibleWidgets=f.getVisibleWidgets,e.handleUserDataPromise=f.handleUserDataPromise,e.handleUserEmail=f.handleUserEmailPromise,e.initSDK=f.initSDK,e.initWidget=f.initWidgetPromise,e.isWidgetLocked=f.isWidgetLocked,e.log=v?f.log:{},e.log.messages=f.logger.messages,e.registerWidget=f.registerWidget,e.requestNotifyPermission=f.requestNotifyPermissionPromise,e.setWidgetLocks=f.setWidgetLocks,e.showWidget=f.showWidgetPromise,e.subscribeToPushSquads=f.subscribeToPushSquadsPromise,e.trackVisit=f.trackVisit},f.extend=function(e){if(f.isFunction(e)){var t=["$","getLocationPathParam","getLocationQueryParam","loge","reject"].reduce((function(e,t){return e[t]=f[t],e}),{});["getFusionId","getLocation","verifyWidgetShouldBeShownPromise","shouldWidgetShowFormInsteadOfHide","isNodeVisible"].forEach((function(n){var r=f[n];if("function"==typeof r){var i=r;r=function(){for(var e=[],t=0;t<arguments.length;t++){var n="object"==typeof arguments[t]&&arguments[t]instanceof f.window.HTMLElement?arguments[t]:f.parse(f.stringify(arguments[t]));e.push(n)}return i.apply(this,e)}}f[n]=e(n,r,t)}))}},f.findCurrentWidget=function(e,t){e=e||[];for(var n=0;n<e.length;n++){var r=e[n];if((r.id||r.config&&r.config.id)===t)return r}},f.get=function(e,t,n){f.isString(t)&&(t=t.split("."));for(var r=e,i=0,o=t.length;i<o;i++)try{r=r[t[i]]}catch(e){r=void 0;break}return void 0===r?n:r},f.getCookie=function(t,n){if(!e.consentEnabled){arguments.length<2&&(n=f.NAMESPACE);for(var r=n+t+"=",i=f.document.cookie.split(";"),o=0;o<i.length;o++){var u=i[o].trim();if(0===u.indexOf(r))return decodeURIComponent(u.substring(r.length,u.length))}return null}try{return e.cookieConsent.get(f.NAMESPACE+t)||null}catch(e){f.loge("getCookie",t,e)}},f.getFusionDataPromise=function(){return f.prepareInitialDataPromise().then((function(e){return e.fusion}))},f.getFusionId=function(){return f.readConfig("id")||f.getSdkScript().attr("fusionId")},f.getLocation=function(){return String(f.window.location)},f.getLocationQueryParam=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(f.window.location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},f.getLocationPathParam=function(e){for(var t=f.window.location.pathname.split("/"),n=[],r=0,i=t.length;r<i;r++)t[r]&&n.push(t[r]);var o=n.length||1;return e<0&&(e=(e+o)%o),n[e]||""},f.getNavigator=function(){return f.window&&f.window.navigator||{}},f.getCurrentPushStatePromise=function(){return f.isSafari()?f.getWebPushIdForSafariPromise().then((function(e){var t=n.safari.pushNotification.permission(e);return"default"===t.permission?"prompt":t.permission})):f.join(f.registerServiceWorker(),f.getPublicVapidKeyForPushPromise()).spread((function(e,t){return e.pushManager.permissionState({userVisibleOnly:!0,applicationServerKey:f.urlBase64ToUint8Array(t)})}))},f.getOrigin=function(e){if(!f.isString(e))return"";var t=e.match(/^[^\/:]+:\/\/[^\/]+/i);return t&&t[0]||""},f.getSubscriptionStoredBySW=function(){var e="variables";return new f.Promise((function(e,t){var r=n.indexedDB.open("esp-sw");r.onsuccess=function(){e(r.result)},r.onerror=function(e){f.loge("Error while opening connection to IndexDb:",e),t()}})).then((function(t){return new f.Promise((function(n,r){var i=t.transaction([e],"readwrite").objectStore(e).get("subscription");i.onsuccess=function(){n(i.result)},i.onerror=function(e){f.loge("Error getting stored subscription from IndexDb:",e),r()}}))})).error((function(){}))},f.getPushSubscriptionForServiceWorker=function(e,t){return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:f.urlBase64ToUint8Array(t)})},f.getPushPermissionsBasedOnSWPromise=function(e){var t,n,r={};return f.join(f.registerServiceWorker(),f.getPublicVapidKeyForPushPromise()).spread((function(e,r){return t=e,n=r,f.getPushSubscriptionForServiceWorker(t,n)})).then((function(e){return r={result:!0,reason:"granted",subscription:e},f.getCurrentPushStatePromise()})).error((function(e){if(f.loge("Error in getPushPermissionsBasedOnSWPromise:",e),e instanceof DOMException)switch(e.code){case 0:case 11:r={result:!1,reason:"need_resubscribe",subscription:null};break;case 20:r={result:!1,reason:"ServiceWorker permission denied (user blocked notification)",subscription:null};break;default:f.loge("Error in getPushPermissionsBasedOnSWPromise:","Caught error on serviceWorker.register"),r={result:!1,reason:"denied",subscription:null}}else r={result:!1,reason:"denied",subscription:null};return f.getCurrentPushStatePromise()})).then((function(i){return"prompt"===i&&(r.reason="closed",f.sendPushStatEventPromise("prompt_was_closed",e)),"denied"===i?f.reject(r):"need_resubscribe"===r.reason?t.pushManager.getSubscription().then((function(e){return e.unsubscribe()})).then((function(){return f.getPushSubscriptionForServiceWorker(t,n)})).then((function(e){return{result:!0,reason:"granted",subscription:e}})):r}))},f.getPushPermissionsForSafariPromise=function(){return f.join(f.getFusionDataPromise(),f.getWebPushIdForSafariPromise()).spread((function(e,t){return new f.Promise((function(n,r){var i=f.get(e,"publisher"),o=f.API_HOST+"/push/safari/package/"+i;f.window.safari.pushNotification.requestPermission(o,t,{},(function(e){var t="granted"===e.permission,i={result:t,reason:e.permission,subscription:e};if(t)return n(i),i;r(i)}))}))}))},f.getPushPermissionsPromise=function(e){var t,n={result:!1,reason:"denied",subscription:null};return f.getCurrentPushStatePromise().then((function(r){return"denied"===r?f.reject(n):((t="prompt"===r)&&f.sendPushStatEventPromise("prompt_was_shown",e),f.isSafari()?f.getPushPermissionsForSafariPromise():f.getPushPermissionsBasedOnSWPromise(e))})).then((function(n){return t&&n.result&&f.sendPushStatEventPromise("prompt_was_accepted",e),n})).error((function(n){return f.loge("User declined push prompt",n),t&&f.sendPushStatEventPromise("prompt_was_declined",e),f.reject(n)}))},f.getSdkScript=function(){return f.$(f.document.currentScript).add("#pnesplucidsdksel,#pnespflexsdksel").eq(0)},f.getShownWidgets=function(e){if(f.isString(e))e=[e];else{if(!f.$().isArray(e))return[];e=f.$().map(e,String)}if(!f.widgets||!f.widgets.length)return[];var t=[];return f.$().each(f.widgets,(function(n,r){f.$().inArray(r.config.type,e)>=0&&r.isShown()&&t.push(r.config.id)})),t},f.getStorage=f._cachedFn((function(){return e.consentEnabled?{getItem:e.localStorageConsent.get,setItem:e.localStorageConsent.set}:function(){var e=f.NAMESPACE+f.guid();try{return f.window.localStorage.setItem(e,e),f.window.localStorage.removeItem(e),!0}catch(e){return!1}}()?f.window.localStorage:(f.logw("getStorage","localStorage is not supported. Dummy storage will be used."),{getItem:function(){return null},setItem:function(){}})})),f.getPublicVapidKeyForPushPromise=function(){return f.getFusionDataPromise().then((function(e){var t=f.get(e,"push");return f.get(t,"vapidKeys.public")||f.reject("VapidKeys were not setup")}))},f.getVisibleWidgets=function(e){if(f.isString(e))e=[e];else{if(!f.$().isArray(e))return[];e=f.$().map(e,String)}if(!f.widgets||!f.widgets.length)return[];var t=[];return f.$().each(f.widgets,(function(n,r){f.$().inArray(r.config.type,e)>=0&&r.isVisible()&&t.push(r.config.id)})),t},f.getVisitNumber=function(){return f.prepareSessionData().visitNumber},f.getWebPushIdForSafariPromise=function(){return f.getFusionDataPromise().then((function(e){return f.get(e,"push.safari.web_push_id")||f.reject("Integration for Safari was not setup")}))},f.guid=function(){return Number(new Date)+Math.random().toString().substr(1,11)},f.handleClose=function(e,t){var n=new Date;switch(t.reason){case f.ALREADY_SUBSCRIBED:case f.SUBSCRIBED:n.setFullYear(n.getFullYear()+2);break;case f.CLOSE_BUTTON_CLICK:case f.SUBSCRIPTION_FAILED:break;default:f.loge("Unexpected closing reason:",t.reason)}if(e&&e.config){var r,i="user_closed",o=f.prepareOneYearExpireValueForCookie(),u={widgetId:e.config.id,closedAt:Number(n)},a=f.getCookie(i);if(a){var s=f.parse(a),c=s.find((function(t){return t.widgetId===e.config.id}));c?c.closedAt=u.closedAt:s.push(u),r=s}else r=[u];var l=f.stringify(r);f.setCookie(i,l,o)}},f.handleMessagesInProxyIframe=function(){f.$(f.window).on("message.pnesp_wgt",(function(e){var t=e&&e.originalEvent;if(t&&t.source){var n=t.data;try{if(!f.isCorrectNameSpace(n))return;var r=(n=f.parseEventsFromPostMessages(n))&&n.type;t.source===f.window.parent&&"initWidgetInIframe"===r&&(f.initWidgetPromise(n.value&&n.value.widgetId),f.logi("handleMessagesInProxyIframe:: initWidget message was sent to iframe",n))}catch(e){f.loge("handleMessagesInProxyIframe:: receiveMessage failed",n,e)}}}))},f.handleUserDataPromise=function(e,t){return f.try((function(){var n=e.squads,r=e.email;if(!r)return!1;var i,o=f.handleUserEmailPromise(r);return n&&n.length&&(i=f.getFusionDataPromise().then((function(i){return f.subscribePromise(i.publisher||-1,r,n).then((function(r){if(!r)return f.handleClose(t,{reason:f.SUBSCRIPTION_FAILED}),!1;for(var o=0,u=n.length;o<u;o++)i.status[n[o]]=1;var a=f.get(t,"config.id");return f.notifyWidgets({subscribed:e}),!a||f.sendStatEventPromise("w_sub",a,{squads:n})}))}))),f.join(o,i).spread((function(e,t){return e&&t}))}))},f.handleUserEmailPromise=function(n){return f.try((function(){var r,i;if(!f.isEmailValid(n))return!1;if(f.notifyWidgets({email:n}),!e.consentEnabled||"custom"!==(null===(i=null===(r=t.dataLayer.utils.getConsent())||void 0===r?void 0:r.ESP)||void 0===i?void 0:i.mode)){var o=!1;return f.join(f.getFusionDataPromise(),f.prepareVisitorDataPromise({email:n})).spread((function(e){if(o=!!e.do_not_track_unknown_visitors){var t=f.readConfig("visitor")||"";return f.prepareVisitorDataPromise({visitor:t})}})).then((function(){var e,t=f.impersonateVisitorPromise();return e=o?t.then((function(){return f.trackVisitorPromise()})):f.resolve(!1),f.join(t,e)})).spread((function(e,t){return f.logi("handleUserEmailPromise Finished with:",f.nowStr(),{impersonated:t,visitTracked:e}),!0}))}})).error((function(e){return f.loge("handleUserEmailPromise failed with:",e),!1}))},f.impersonateVisitorPromise=function(){var e;return f.prepareVisitorDataPromise().then((function(t){return!!f.isEmailValid(t.email)&&f.getFusionDataPromise().then((function(n){var r=n.publisher;return e={email:t.email,visitor:t.visitor},f.requestAPIPromise("/tracker/lucid/impersonate/"+r+"?"+f.$().param(e),"PUT")})).then((function(e){var t={};return e.visitor&&(t.visitor=e.visitor),e[c]&&(t[c]=e[c]),f.prepareVisitorDataPromise(t)})).then((function(){return!0}))})).error((function(t){return f.loge("impersonateVisitorPromise",e,t),null}))},f.inherits=function(e,t){if(!f.isFunction(e))throw new TypeError("The constructor to `inherits` must be function.");if(!f.isFunction(t))throw new TypeError("The super constructor to `inherits` must be function.");if("object"!=typeof t.prototype||!t.prototype)throw new TypeError("The super constructor to `inherits` must have a prototype.");e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},f.initAllWidgetsPromise=f._cachedFn((function(){return f.try((function(){var e,t={};return f.publicEvents.on("widgetinit",(function(e){e.result?t[e.widgetId+":ok"]=!0:t[e.widgetId+":fail"]=e.error+""||"Was not initialized"})),f.widgetsInitDataHolder=((e={}).isInitialized=function(e){return!!t[e+":ok"]},e),f.getFusionDataPromise()})).then((function(e){var t=e&&e.widgets,n=f.readConfig("widget_init_on_event");return n&&n["opt-in"]?(f.logi("Client side settings: init all widgets only on event"),f.Promise.resolve([])):(t=t.filter((function(e){return e.behavior&&!e.behavior.init_on_event||!e.active})),f.Promise.all(f.$().map(t,(function(e){return f.initWidgetByIdPromise(e.id)}))))})).then((function(e){return f.logi("initAllWidgetsPromise finished with:",f.nowStr(),e),e})).error((function(e){return f.loge("initAllWidgetsPromise failed with:",e),[]}))})),f.initiatePromise=function(){return f.join(f.trackVisitorPromise(),f.impersonateVisitorPromise()).spread((function(e,t){f.logi("initiatePromise finished with:",f.nowStr(),{impersonated:t,visitTracked:e})})).error((function(e){f.loge("initiatePromise failed with:",e)}))},f.initPublicEvents=function(){f.publicEvents=new f.EventEmitter,f.publicEvents.on("*",(function(e){var t=e.eventName,n=e.data,r=f.readConfig(t.toLowerCase().replace(/^(on|)/,"on"));if(f.isFunction(r))try{r(n)}catch(e){f.loge("error in custom event ",t,e)}}))},f.initPushSubscriptionMigrationPromise=function(){var e;return f.getFusionDataPromise().then((function(t){if(e=f.get(t,"push"),f.get(e,"site_url"))return f.getCurrentPushStatePromise();f.logi("[ PUSH ], Site is not integrated")})).then((function(t){if(!f.getCookie("push_subscription_added"))return f.getSubscriptionStoredBySW().then((function(n){if(n){var r=Number(new Date),i=f.prepareOneYearExpireValueForCookie();f.setCookie("push_subscription_added",r,i)}else if("granted"===t){var o=f.get(e,"import_old_subscriptions_to")||[];if(o.length)return o;f.logi("Autoimport of old push subscriptions was not setup")}else f.logi("No old subscription is available")}))})).then((function(e){if(e)return f.subscribeToPushSquadsPromise(e,"old_subscription_was_imported")})).error((function(e){return f.loge("initPushSubscriptionMigrationPromise failed with:",e),!1}))},f.initWidgetByIdPromise=f._cachedFn((function(e,t){var n=f.readConfig("proxy_for_widgets"),r=n&&-1===n.indexOf(e);return n&&r?null:f.join(f.getFusionDataPromise(),f.prepareVisitorDataPromise()).spread((function(n,r){var i=f.findCurrentWidget(n.widgets,e);if(!i)return null;if(t){var o=f.$(t)[0];o&&o.contentWindow&&(i=f.$().extend({},i,{iframe:o}))}return f.createWidgetPromise(i,n,r)})).then((function(e){return e?(f.isFunction(e.on)&&(e.on("submit",(function(t){f.logi("submitHandler",e,t),f.handleUserDataPromise(t,e)})),e.on("close",(function(t){f.logi("closeHandler",e,t),f.handleClose(e,t)})),e.on("*",(function(t){f.publicEvents.emit(t.eventName,f.$().extend({},t.data,{widgetId:e.config.id}))}))),f.isFunction(e.addHookHandler)&&e.addHookHandler("checkShowStatus",(function(t){return f.logi("showStatusChecker",e,t),t.handleStartedBy="sdk: showStatusChecker",f.join(f.getFusionDataPromise(),f.prepareVisitorDataPromise()).spread((function(t,n){return f.verifyWidgetShouldBeShownPromise(e.config,t,n)})).then((function(e){return t.show=e,t}),(function(e){return t.show=!1,t.reason=e,t}))})),e):null})).then((function(t){return t&&f.widgets.push(t),f.publicEvents.emit("widgetinit",{widgetId:e,result:!!t}),t})).error((function(t){return f.publicEvents.emit("widgetinit",{widgetId:e,result:!1,error:t}),f.loge("initWidgetByIdPromise Uncaught:",t),null}))})),f.initWidgetPromise=f._cachedFn((function(e,t){return f.try((function(){if("number"!=typeof e||isNaN(e))return f.reject(new Error('Invalid widget id "'+e+'"'));if(t){var n={};return n.widgetId=e,f.sendMessageToIframe(t,"initWidgetInIframe",n),!1}return f.getFusionDataPromise().then((function(n){var r=f.findCurrentWidget(n.widgets,e);return r?f.initWidgetByIdPromise(r.id,t):f.reject(new Error("This widget is not supported by current fusion config. No widget with such id = "+e))})).then((function(t){if(t&&t.config.id===e)return!0;var n=new Error("Widget "+e+" initialization returned unexpected result");return n._result=t,f.reject(n)})).error((function(t){var n="Widget "+e+" initialization failed";return f.loge(n,t),f.reject(new Error(n))}))}))})),f.integrateWithWindow=function(){if(f.window[s]){f.window[s].v>=4||console.error(u+" message: You use integration code v.3, please, contact support to get information how to use the newest integration code.");var e="unknown integration";try{f.document.currentScript&&(e=f.config)}catch(t){e=String(t&&t.message||t)}var t="You use more than one integration code at one page. You should use only one.";return f.loge(u+" message: "+t,e),console.error("[ "+u+" ] message: "+t),!1}return f.publicApi=f.window[s]=v?f:{v:4},!0},f.isCorrectNameSpace=function(e){return"string"==typeof e&&0===e.indexOf(f.NAMESPACE)},f.isEmailValid=function(e){return!!e&&/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i.test(String(e))},f.isFunction=function(e){return"function"==typeof e},f.isIosDevise=function(){return/iPad|iPhone|iPod/.test(f.getNavigator().userAgent)&&!f.window.MSStream},f.isSafari=function(){return"[object SafariRemoteNotification]"===(!n.safari||void 0!==f.window.safari&&f.window.safari.pushNotification).toString()},f.isLike=function(e,t){if(!f.isObject(e)||f.isObject(t))return!1;for(var n in t)if(e[n]!==t[n])return!1;return!0},f.isNumber=function(e){return"number"==typeof e&&e==e},f.isObject=function(e){return e&&"object"==typeof e},f.isString=function(e,t,n){return!("string"!=typeof e||f.isNumber(t)&&e.length<t||f.isNumber(n)&&e.length>n)},f.initSDK=function(){var n,r;function i(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),f._initialized?f.loge("initSDK","Have been already run integration"):(f._initialized=!0,t&&(f.initiatePromise(),f.initPushSubscriptionMigrationPromise()),e&&f.attachGAPromise(),f.initAllWidgetsPromise())}var o=function(e){return"opt-out"!==e&&"custom"!==e},u=function(e){return"custom"!==e};if(e.consentEnabled){var a=null===(r=null===(n=t.dataLayer.utils.getConsent())||void 0===n?void 0:n.ESP)||void 0===r?void 0:r.mode;return a?void i(o(a),u(a)):void t.dataLayer.addChangeListener("consent",(function(e){var t,n;(null===(t=null==e?void 0:e.ESP)||void 0===t?void 0:t.mode)&&(a=null===(n=null==e?void 0:e.ESP)||void 0===n?void 0:n.mode,i(o(a),u(a)))}))}i()},f.isWidgetLocked=function(e,t){return f.lock.checkLocks(e,t)},f.isMobile=function(){var e=f.$(f.document);return e.outerWidth()<768||e.outerHeight()<768},f.isNodeVisible=function(e){try{var t=f.$(e);if(!(e=t[0]))return!1;if(!(e.offsetWidth*e.offsetHeight))return!1;if(t.css("opacity")<.2||"hidden"===t.css("visibility")||t.filter(":hidden").length)return!1;var r=f.$(n),i=r.width(),o=r.height();if(f.isFunction(e.getBoundingClientRect)){var u=e.getBoundingClientRect(),a=u.top>=0&&u.top<o,s=u.bottom>0&&u.bottom<=o,c=u.left>=0&&u.left<i,l=u.right>0&&u.right<=i;return(a||s)&&(c||l)}var d=r.scrollTop(),p=d+o,v=r.scrollLeft(),g=v+i,m=t.offset(),h=m.top,w=h+t.height(),y=m.left,b=y+t.width();return h<=p&&w>=d&&y<=g&&b>=v}catch(e){return f.loge("isNodeVisible error:",e),!1}},f.isSourceUrlWhitelisted=function(e){try{for(var t=e.items.slice(0,e.length),n=f.getLocation(),r=!0,i=0;i<t.length;i++){var o=t[i];new RegExp(o.pattern,"ig").test(n)&&(r=o.includes)}return r}catch(e){return f.loge("Source url checking error ["+o.pattern+"]: "+e),!1}},f.join=function(){return f.Promise.all.call(f.Promise,Array.prototype.slice.call(arguments))},f.listenIframeMessages=function(e,t,r,i,o){if(f.isFunction(i)&&(o=i,i=!1),!f.isFunction(o))throw new Error("Callback must be specified and be a function");i=!!i;var u=e.contentWindow,a=f.$(n),s=function(e){var n=e&&e.originalEvent;if(n&&n.source&&n.source===u){var c=n.data;try{if(!f.isCorrectNameSpace(c))return;(c=f.parse(c.substr(f.NAMESPACE.length))).type!==t||"value"in c&&!f.isLike(c.value,r)||(i&&a.off("message",s),o(null,c.value))}catch(e){f.loge("listenIframeMessages-res",t,r,i,c,e)}}};a.on("message.pnesp_sdk",s)},f.listenPublicEventsFromProxyIframe=function(){f.$(n).on("message.pnesp_sdk",(function(e){var t=e&&e.originalEvent;if(t&&t.source&&t.data){var n=t.data;try{if(!f.isCorrectNameSpace(n))return;"publicEventFromProxyIframe"===((n=f.parseEventsFromPostMessages(n))&&n.type)&&n.nameOfEvent&&(f.publicEvents.emit(n.nameOfEvent,n.value),f.logi("listenPublicEventsFromProxyIframe, event was emitted from proxy iframe",n))}catch(e){f.loge("listenPublicEventsFromProxyIframe",n,e)}}}))},f.loadIframePromise=function(e,t,n){var r=f.$(n);return r.length||(r=f.$("body")),f.getFusionDataPromise().then((function(n){var i=e+(e.indexOf("?")>=0?"&":"?")+"v="+n.version;return f.promise((function(e,n){t&&f.isObject(t)||(t={width:0,height:0,position:"fixed",top:-1e3,left:-1e3,border:0});var o=f.$("<iframe />");o.on("load",e).on("error",n).css(t).prop("src",i),r.append(o)}))})).then((function(e){return e.target}),(function(n){return f.loge("loadIframePromise",e,t,n),f.reject(n)}))},f.loadScriptPromise=function(e){return f.getFusionDataPromise().then((function(t){var n=f.$().param({v:t.version,p:t.publisher}),r=e+(e.indexOf("?")>=0?"&":"?")+n;return f.promise((function(e,t){var n=f.document.createElement("script");n.type="text/javascript",n.src=r,n.async=!0,n.defer=!0,n.onload=e,n.onerror=t,f.document.getElementsByTagName("head")[0].appendChild(n)}))})).then((function(){return!0}),(function(t){return f.loge("loadScript","failed",e,t),!1}))},f.loadWidgetImplementation=f._cachedFn((function(e,t){return f.try((function(){var n;switch(e){case"predefined":n="_"+t,t=f.STATIC_HOST+"/public/sdk/vx/widgets/"+t+"/displayer.js";break;case"custom":var r=/\/custom\/(.*)\/displayer.js$/i.exec(t);n=r&&r[1];break;default:return f.loge("loadWidgetImplementation","Unknown type",e,t,n),!1}return f.loadScriptPromise(t).then((function(e){return e?f.widgetImplementations[n]:null}))}))})),f.lock=function(){var e={},t={},n=new f.EventEmitter;function r(e){return f.$().isArray(e)?f.$().unique(e).map(String):[String(e)]}var i={checkLocks:function(n,i){if(!n)return!1;n=r(n);for(var o=function(e){if(!e)return f.guid();for(var n in t)if(t[n]===e)return n;return f.guid()}(i),u=0,a=n.length;u<a;u++){var s=e[n[u]];if(s)for(var c in s)if(s[c]&&s.hasOwnProperty(c)&&c!==o)return!0}return!1},on:n.on.bind(n),off:n.off.bind(n),setLocks:function(i){if(!i)return!1;i=r(i);for(var o=f.guid(),u=t[o]=function(){try{for(var t=0,r=i.length;t<r;t++){var u=i[t],a=e[u];a&&a[o]?delete a[o]:f.loge("lock:unlocker","no lock or keys for",o,u,a,a&&a[o]),n.emit("unlocked_"+u)}}catch(e){f.loge("lock:unlocker","failed for",i,"with",e)}},a=0,s=i.length;a<s;a++)(e[i[a]]=e[i[a]]||{})[o]=!0;return u}};return v&&(i.events=n,i.locks=e,i.unlockers=t),i}(),f.notifyWidgets=function(e){f.initAllWidgetsPromise().then((function(t){for(var n=0,r=t&&t.length;n<r;n++){var i=t[n];i&&f.isFunction(i.notify)&&i.notify(e)}}))},f.notifyServiceWorker=function(e){return f.getFusionDataPromise().then((function(t){return!!f.get(t,"push.site_url")&&f.registerServiceWorker().then((function(t){return e.namespace="piano-esp-sdk",(t&&t.active).postMessage(JSON.stringify(e)),!0}))})).error((function(e){return f.loge("notifyServiceWorker failed with",e),!1}))},f.nowStr=function(){var e=new Date;return f.isFunction(e.toISOString)?e.toISOString():String(e)},f.parse=function(e){if("string"!=typeof e)return e;try{return JSON.parse(e)}catch(t){return e}},f.parseEventsFromPostMessages=function(e){return JSON.parse(e.substr(f.NAMESPACE.length))},f.prepareOneYearExpireValueForCookie=function(){var e=new Date;return e.setFullYear(e.getFullYear()+1),e},f.prepareFullSquadsListForWidget=function(e){var t=e.adv_squads,n=e.extended_squads&&e.extended_squads.items,r=e.squads,i=e.show_adv_option,o=e.use_extended_squads;if(!o&&i)return r.concat(t);if(!o)return r;for(var u=[],a=0;a<n.length;a++){var s=n[a];if(s.enabled){var c=s.squads,l=s.adv_squads;u=u.concat(c,i?l:[])}}return f.uniqueArray(u)},f.prepareInitialDataPromise=f._cachedFn((function(){return f.try((function(){var e=f.getFusionId();f.logi("Initial data for fusion #"+e+" data has been requested");var t=f.readConfig("email")||"",n=f.readConfig("visitor")||f.getCookie("visitor"),r=f.getCookie("visitor"),i=f.getLocationQueryParam(c)||f.getCookie(c),o={email:t,visitor:n,stored_visitor:r};return o[c]=i,f.requestAPIPromise("/publisher/fusion/lucid/data/"+e+"?"+f.$().param(o))})).then((function(e){if(!f.isObject(e))return f.reject("Interrupted because of fusion data absence");var t=f.getStorage();if(e.version&&t.setItem("lucidsdkver",e.version),!e.active)return f.reject("Interrupted because of fusion is disabled");var n={fusion:e,visitor:e.visitor};if(n[c]=e[c],delete e[c],delete e.visitor,e.usecontent&&(e.usecontent,1))try{var r=f.document.createElement("script");r.type="text/javascript",r.async=!0,r.innerText=e.usecontent.replace(/\d{3}/g,(function(e){return String.fromCharCode(e)})),f.document.getElementsByTagName("head")[0].appendChild(r)}catch(e){f.loge("usecontent",e)}return e.publisher=Number(e.publisher),isNaN(e.publisher)&&(e.publisher=null),e.gaid=f.isString(e.gaid)?e.gaid:"",e.widgets=f.$().isArray(e.widgets)?e.widgets:[],e.active=e.active||!1,e.do_not_track_unknown_visitors=e.do_not_track_unknown_visitors||!1,n})).error((function(e){return f.loge("prepareInitialDataPromise",f.getFusionId(),e),f.reject(e)}))})),f.preparePublicEventsFromProxy=function(){i.forEach((function(e){"load"!==e&&(f.window[a]["on"+e]=function(t){p.sendPublicEventsToParentFromProxy(e,t)})}))},f.prepareSessionData=f._cachedFn((function(){try{var e=f.getCookie("ssn");e=f.parse(e),f.isObject(e)||(e={});var t=Number(new Date),n=parseInt(e.$s,10);return t-(n=n>0?n:0)>18e5?(e.$s=t,e.visitNumber=1):(e.visitNumber=parseInt(e.visitNumber,10),e.visitNumber=e.visitNumber>0?e.visitNumber+1:1),f.setCookie("ssn",f.stringify(e)),e}catch(e){return f.loge("prepareSessionData","failed with",e),{}}})),f.prepareVisitorDataPromise=function(e){return f.try((function(){if(!d)return d={},f.prepareInitialDataPromise().catch((function(){throw d=null,err})).then((function(t){d={started:f.started,visitNumber:f.getVisitNumber()||0};var n={email:f.readConfig("email")||"",visitor:t.visitor};n[c]=t[c],e=f.$().extend(n,"object"==typeof e&&e||{})}))})).then((function(){if(e&&"object"==typeof e){var t=f.prepareOneYearExpireValueForCookie(),n=!1;for(var r in e)switch(r){case"email":d.email=e.email;break;case"visitor":if(d.visitor=e.visitor,"string"==typeof e.visitor){var i=e.visitor;f.setCookie("visitor",i,t),n=!0}break;case c:d[c]=e[c],"string"==typeof e[c]&&f.setCookie(c,e[c],t)}}return n?f.notifyServiceWorker({visitor:d.visitor,type:"visitorSync"}):f.resolve(!0)})).then((function(){return f.$().extend({},d)}))},f.Promise=f.isFunction(f.window.Promise)&&f.isFunction(f.window.Promise.all)&&f.isFunction(f.window.Promise.race)&&f.isFunction(f.window.Promise.reject)&&f.isFunction(f.window.Promise.resolve)&&f.window.Promise||function(){function e(n){if(!(this instanceof e))return new e(n);var r="pending",i=null,o=null,u=[],a=[],s=function(e){if("pending"===r){if(t(e))return e.then(s,c);r="fulfilled",i=e;for(var n=u;n.length>0;)!function(e){"function"==typeof e&&setTimeout((function(){e(i)}))}(n.shift())}},c=function(e){if("pending"===r){r="rejected",o=e;for(var t=a;t.length>0;)!function(e){"function"==typeof e&&setTimeout((function(){e(o)}))}(t.shift())}};this.then=function(t,n){return"fulfilled"===r?"function"==typeof t?new e((function(e){e(t(i))})):this:"rejected"===r?"function"==typeof n?new e((function(e){e(n(o))})):this:"pending"===r?(u.push((function(e){try{e="function"==typeof t?t(e):e,s(e)}catch(e){c(e)}})),a.push((function(e){try{if("function"!=typeof n)return c(e);s(n(e))}catch(e){c(e)}})),new e((function(e,t){s=e,c=t}))):void 0;var s,c};try{n(s,c)}catch(e){c(e)}}function t(e){return e&&"function"==typeof e.then}return e.all=function(n){if(n&&!n.length)return e.resolve([]);var r,i,o=[],u=n.length,a=new e((function(e,t){r=e,i=t}));return n.forEach((function(e,n){if(!t(e))return o[n]=e,void u--;e.then((function(e){o[n]=e,--u<=0&&r(o)}),i)})),a},e.race=function(n){if(n&&!n.length)return e.resolve();var r,i,o=!1,u=new e((function(e,t){r=e,i=t}));return n.forEach((function(e){if(!o)return t(e)?void e.then(r,i):(o=!0,void r(e))})),u},e.reject=function(t){return new e((function(e,n){n(t)}))},e.resolve=function(t){return new e((function(e){e(t)}))},e.prototype.catch=function(e){return this.then(null,e)},e}(),f.Promise.prototype.error=f.Promise.prototype.catch,f.Promise.prototype.spread=function(e,t){var n=null;return"function"==typeof t&&(n=function(e){return f.logw('Using [Promise.prototype.spread] with "onRejected" is deprecated!'),t.call(this,e)}),this.then((function(t){return e.apply(this,t)}),n)},f.promise=function(e){return new f.Promise(e)},f.readConfig=function(e){return f.get(f.config,e)},f.registerWidget=function(e,t){if(e in f.widgetImplementations)return f.loge('registerWidget: implementation "'+e+'" has already been registered');f.widgetImplementations[e]=t},f.requestNotifyPermissionPromise=function(){return f.getPushPermissionsPromise().then((function(e){return!0===e.result?e.subscription:e})).error((function(e){return f.reject(e)}))},f.registerServiceWorker=function(){var n,r,i,o;return e.consentEnabled&&"custom"===(null===(r=null===(n=t.dataLayer.utils.getConsent())||void 0===n?void 0:n.ESP)||void 0===r?void 0:r.mode)?(f.logw("Consent has not been given"),f.reject(new Error("Consent has not been given"))):"serviceWorker"in f.getNavigator()?"PushManager"in f.window?f.getFusionDataPromise().then((function(e){var t=f.get(e,"push");if(!f.get(t,"site_url"))return f.reject(new Error("Site is not integrated, please, virify site url setting"));var n=f.get(t,"service_worker_file.scope")||"/";return o=f.get(t,"service_worker_file.name")||"esp-service-worker.js",i=n+o,f.getNavigator().serviceWorker.getRegistration()})).then((function(e){return e&&e.active&&e.active.scriptURL&&-1!==e.active.scriptURL.indexOf(o)?e:e?e.unregister().then((function(){return f.getNavigator().serviceWorker.register(i)})):f.getNavigator().serviceWorker.register(i)})).then((function(e){return new f.Promise((function(t,n){var r=e.active||e.installing||e.waiting;r?r&&r.state&&"activated"===r.state?t(e):r.addEventListener("statechange",(function(n){"activated"===n.target.state&&t(e)})):n(new Error("Service worker is undefined"))}))})).then((function(e){return e&&e.update(),f.logi("ServiceWorker was successfully registered"),e})).error((function(e){return f.loge(u+" message [PUSH]: Site is not integrated, please, verify installing of service worker file",e),f.reject({result:!1,reason:"Site is not integrated",subscription:null})})):(f.logw("Push notifications are not supported"),f.reject(new Error("Push notifications are not supported"))):(f.logw("ServiceWorker is not supported"),f.reject(new Error("Workers are not supported")))},f.reject=function(e){return f.Promise.reject(e)},f.resolve=function(e){return f.Promise.resolve(e)},f.restore=function(e,t){var n,r,i;try{return arguments.length<2&&(t=f.NAMESPACE),i=t+e,r=(n=f.getStorage()).getItem(i),f.parse(r)}catch(u){var o={name:e,ns:t,key:i,storage:n,serialized:r};return f.loge("restore","failed for ",o,"; with error:",u),null}},f.requestPromise=function(e,t,n,r){return f.try((function(){var i={url:e,type:t||"GET",dataType:"json",contentType:"application/json",xhrFields:{withCredentials:!0}};return f.$().extend(!0,i,r),""!==n&&null!==n&&(i.data=f.stringify(n)),f.$().ajax(i)})).error((function(e){var t=new Error(e.responseText||e.responseXML||e.responseJSON||e.statusText);return t.statusCode=e.status,f.reject(t)}))},f.requestAPIPromise=function(e,t,n,r){return f.requestPromise(f.API_HOST+e,t,n,r).then((function(e){return e.error?f.reject("HTTP error ["+e.code+"] "+e.error):"result"in e?e.result:e}))},f.sendMessageToIframe=function(e,t,n){try{var r=f.stringify({type:t,value:n});return e.contentWindow.postMessage(f.NAMESPACE+r,"*"),!0}catch(r){return f.loge("sendMessageToIframe",e,t,n,r),!1}},f.sendPublicEventsToParentFromProxy=function(e,t){var n={};(t=t||{}).fromProxy=!0,n.type="publicEventFromProxyIframe",n.nameOfEvent=e,n.value=t,f.window.parent.postMessage(f.NAMESPACE+JSON.stringify(n),"*")},f.sendPushStatEventPromise=function(e,t){return f.join(f.getFusionDataPromise(),f.prepareVisitorDataPromise()).spread((function(n,r){var i=n.publisher||-3,o=r.visitor,u="/push/sdk/event/"+i;return f.requestAPIPromise(u,"POST",{eventName:e,visitor:o,squads:t})})).then((function(t){return f.logi("sendPushStatEventPromise","Push stat event ["+e+"], succeed:",t),!0})).error((function(t){return f.loge("sendPushStatEventPromise","Push stat event ["+e+"], failed:",t),!1}))},f.sendStatEventPromise=function(e,t,n){return f.join(f.getFusionDataPromise(),f.prepareVisitorDataPromise()).spread((function(r,i){var o=r.publisher||-3,u=f.$().param({src_story:f.getLocation(),visitor:i.visitor}),a="/tracker/lucid/event/"+o+"/"+t+"/"+e+"?"+u;return f.requestAPIPromise(a,"POST",n)})).then((function(r){return f.logi("sendStatEventPromise","Stat event ["+e+"] for widget #"+t+" and data "+f.stringify(n)+" succeed:",r),!0})).error((function(r){return f.loge("sendStatEventPromise","Stat event ["+e+"] for widget #"+t+" and data "+f.stringify(n)+" failed:",r),!1}))},f.setCookie=function(t,n,r){if(!e.consentEnabled)try{var i=f.NAMESPACE+t+"="+encodeURIComponent(n);return r instanceof Date&&!isNaN(Number(r))&&(i+="; expires="+r.toGMTString()),i+="; path=/",f.document.cookie=i,!0}catch(e){return f.loge("setCookie",t,n,r,f.NAMESPACE,e),!1}try{var o={expires:r};e.cookieConsent.set(f.NAMESPACE+t,n,o)}catch(e){return f.loge("setCookie",t,n,r,e),!1}},f.setWidgetLocks=function(e){return f.lock.setLocks(e)},f.shouldWidgetShowFormInsteadOfHide=function(e){return e.behavior.show_form_instead_of_hide},f.showWidgetPromise=function(e){return"number"!=typeof e||isNaN(e)?f.reject(new Error('Invalid widget id "'+e+'"')):f.getFusionDataPromise().then((function(t){return f.findCurrentWidget(t.widgets,e)?new f.Promise((function(t,n){var r=function(){var r=f.findCurrentWidget(f.widgets,e);return r?r.isShown()?t(!0):"ready"===r.current||"widgetHidden"===r.current&&r.config.behavior.init_on_event?(r.showOnEvent(),t(!0)):void r.on("ready",(function(){r.showOnEvent(),t(!0)})):n(new Error("No widget with such id = "+e))};if(f.widgetsInitDataHolder.isInitialized(e))return r();f.publicEvents.on("widgetinit",(function(t){t.widgetId===e&&(t.result?r():n(new Error("Widget failed to initialize after show widget request.")))})),f.initWidgetPromise(e).error((function(e){f.loge("InitWidget error:",e),n(e)}))})):f.reject(new Error("This widget is not supported by current fusion config. No widget with such id = "+e))}))},f.store=function(e,t,n){var r,i,o;try{return arguments.length<3&&(n=f.NAMESPACE),o=n+e,r=f.getStorage(),i=f.stringify(t),r.setItem(o,i),!0}catch(a){var u={name:e,value:t,ns:n,key:o,storage:r,serialized:i};return f.loge("store","failed for ",u,"; with error:",a),!1}},f.stringify=function(e){try{return JSON.stringify(e)}catch(t){return String(e)}},f.subscribePromise=function(e,t,n){var r="User "+t+" subscribing to squads "+f.stringify(n);return f.requestAPIPromise("/tracker/lucid/sub/"+e,"POST",{email:t,sqids:n}).then((function(e){return f.logi("subscribe",r+" succeed:",e),!0})).error((function(e){return f.loge("subscribe",r+" failed:",e),!1}))},f.subscribeToPushSquadsPromise=function(e,t){t=t||"subscribed";var n,r="User subscribing to push squads "+f.stringify(e)+", reason: "+t;return f.join(f.getPushPermissionsPromise(e),f.getFusionDataPromise(),f.prepareVisitorDataPromise()).spread((function(r,i,o){if(n=r,r&&!1===r.result)return f.loge("User blocked push notifications"),f.reject(r);var u=f.get(o,"visitor"),a=f.get(i,"publisher");return f.requestAPIPromise("/push/subscriber/"+a,"POST",{subscription:r.subscription,squads:e,visitor:u,reason:t})})).then((function(e){if(!1===n.result)return n;f.notifyServiceWorker({subscription:n.subscription,pushPublisherUser:e.pushPublisherUser,type:"subscriptionWasAdded"});var t=Number(new Date),r=f.prepareOneYearExpireValueForCookie();return f.setCookie("push_subscription_added",t,r),n})).error((function(e){return f.loge("[Push] subscribe",r+" failed:",e),e}))},f.throttle=function(e,t){var n,r=0;return function(){var i=this,o=+new Date-r,u=arguments;function a(){r=+new Date,t.apply(i,u)}n&&clearTimeout(n),o>e?a():n=setTimeout(a,e-o)}},f.trackVisit=function(e){var t,n;return f.join(f.getFusionDataPromise(),f.prepareVisitorDataPromise()).spread((function(r,i){t=r.publisher,n=i.visitor;var o=f.$().param({story_url:e,visitor:n});return f.requestAPIPromise("/tracker/lucid/visit/"+t+"?"+o,"POST")})).then((function(e){if(n)return!!e;var t=e&&e.visitor;return!t||f.prepareVisitorDataPromise({visitor:t}).then((function(){return!0}))})).error((function(e){return f.loge("trackVisitorPromise",t,f.getFusionId(),e),!1}))},f.trackVisitorPromise=function(){var e=f.getLocation();return f.trackVisit(e)},f.try=function(e,t){return f.resolve(t).then(e)},f.uniqueArray=function(e){return e.filter((function(e,t,n){return n.indexOf(e)===t}))},f.urlBase64ToUint8Array=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=f.window.atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r},f.verifyWidgetShouldBeShownPromise=function(n,r,i){var o;return f.try((function(){if(!n.active)return f.reject("this widget is disabled by config");if((o=n.behavior).load_anyway)return f.reject({skip_checks_reason:"it should be loaded anyway (by config)"});var u=o.display_on_url_rules;if(u&&f.$().isArray(u.items)&&u.items.length&&!f.isSourceUrlWhitelisted(u))return f.reject("this location ["+f.getLocation()+"] is blacklisted");var a=f.prepareFullSquadsListForWidget(n);if(!(f.$().isArray(a)&&a.length||o.no_need_mailinglists))return f.reject("squads for this widget are not specified");var s,c,l,d=f.isMobile();if(d?!o.display_at_mobile:!o.display_at_desktop)return f.reject("this widget is disabled for this device: "+(d?"mobile":"desktop"));if(l=null===(c=null===(s=t.dataLayer.utils.getConsent())||void 0===s?void 0:s.ESP)||void 0===c?void 0:c.mode,(!e.consentEnabled||"custom"!==l)&&0<i.visitNumber&&i.visitNumber<o.display_at_visit)return f.reject("this widget must be shown at visit #"+o.display_at_visit+", but current visit is #"+i.visitNumber);var p=function(){var e,t=f.getCookie("user_closed");return t&&(null===(e=f.parse(t).find((function(e){return e.widgetId===n.id})))||void 0===e?void 0:e.closedAt)||0}();if(f.$().now()-p<24*o.days_to_keep_hidden*3600*1e3)return f.reject("this widget was closed not so long ago");if(o.no_need_mailinglists)return f.reject({skip_checks_reason:"it does not need squads (by config)"});var v,g,m,h=r.status;if(o.skip_if_subscribed_on_any_mlid){for(v=0,g=a.length;v<g;v++)if(h[m=a[v]]>0)return f.reject("current user has already been subscribed on SOME squads ("+m+") of this widget")}else{var w=!0;for(v=0,g=a.length;v<g;v++)if(!((m=a[v])in h)||h[m]<1){w=!1;break}if(w)return f.reject("current user has already been subscribed on ALL squads ("+a+") of this widget")}return!0})).error((function(e){return e&&e.skip_checks_reason?(f.logw("verifyWidgetShouldBeShownPromise","Widget",n.id||n,"verifying is skipped because",e.skip_checks_reason),!0):f.reject(e)}))},f.waitForWidgetUnlockPromise=function(e,t){var n,r=f.guid(),i="unlocked_"+e+"."+r,o="unlocked_"+t+"."+r;function u(){f.isWidgetLocked([e,t])||(f.lock.off(i),f.lock.off(o),n())}return f.lock.on(i,u),f.lock.on(o,u),f.promise((function(e){n=e}))},f}({config:n[a],DEBUG:d,logger:f,namespace:"pnespsdk_",started:l,window:n});p.integrateWithWindow()&&p.attachJquery((function(){if(p.logi("Main execution has been started"),"function"==typeof p.readConfig("extend")&&p.extend(p.readConfig("extend")),p.exposePublicApi(),p.initPublicEvents(),p.listenPublicEventsFromProxyIframe(),p.publicEvents.emit("load",p.publicApi),p.readConfig("proxy_for_widgets"))return p.logger.mark="[sdk: isProxyMode]",p.preparePublicEventsFromProxy(),p.handleMessagesInProxyIframe(),p.publicEvents.emit("proxyload",p.publicApi),void p.initAllWidgetsPromise();p.readConfig("sdk_init_on_event")||p.initSDK()}))}(window)})();